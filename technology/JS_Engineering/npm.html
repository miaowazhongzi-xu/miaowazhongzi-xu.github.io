<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>npm | 超赞的博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/style.css">
    <script charset="utf-8" src="/js/custom.js"></script>
    <meta name="description" content="&lt;MyTypewriter/&gt;">
    <meta name="keywords" content="vuepress,自建博客,超赞">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="robots" content="all">
    <meta name="author" content="超赞">
    
    <link rel="preload" href="/assets/css/0.styles.6883bceb.css" as="style"><link rel="preload" href="/assets/js/app.8c8f8633.js" as="script"><link rel="preload" href="/assets/js/8.08618cb1.js" as="script"><link rel="preload" href="/assets/js/1.abb8de29.js" as="script"><link rel="preload" href="/assets/js/14.a5f9e302.js" as="script"><link rel="preload" href="/assets/js/39.76dd4810.js" as="script"><link rel="prefetch" href="/assets/js/10.79c8bd35.js"><link rel="prefetch" href="/assets/js/11.c3fcf0d5.js"><link rel="prefetch" href="/assets/js/12.4c44f9ab.js"><link rel="prefetch" href="/assets/js/13.2d7efa26.js"><link rel="prefetch" href="/assets/js/15.632a290d.js"><link rel="prefetch" href="/assets/js/16.242a87ec.js"><link rel="prefetch" href="/assets/js/17.135d3ff2.js"><link rel="prefetch" href="/assets/js/18.8d8754f9.js"><link rel="prefetch" href="/assets/js/19.164cf4e1.js"><link rel="prefetch" href="/assets/js/20.9a9bec92.js"><link rel="prefetch" href="/assets/js/21.d2c80073.js"><link rel="prefetch" href="/assets/js/22.0b874727.js"><link rel="prefetch" href="/assets/js/23.cac12e71.js"><link rel="prefetch" href="/assets/js/24.f7e63264.js"><link rel="prefetch" href="/assets/js/25.5d2e339e.js"><link rel="prefetch" href="/assets/js/26.51bf83bf.js"><link rel="prefetch" href="/assets/js/27.c4e922e3.js"><link rel="prefetch" href="/assets/js/28.75c7702e.js"><link rel="prefetch" href="/assets/js/29.efc59a99.js"><link rel="prefetch" href="/assets/js/30.7e9d4535.js"><link rel="prefetch" href="/assets/js/31.978a78d9.js"><link rel="prefetch" href="/assets/js/32.4f78b4e3.js"><link rel="prefetch" href="/assets/js/33.4b8c827d.js"><link rel="prefetch" href="/assets/js/34.3e1b8c0f.js"><link rel="prefetch" href="/assets/js/35.d31f0c30.js"><link rel="prefetch" href="/assets/js/36.a6f83163.js"><link rel="prefetch" href="/assets/js/37.23945b23.js"><link rel="prefetch" href="/assets/js/38.0654ebe7.js"><link rel="prefetch" href="/assets/js/4.a89591d2.js"><link rel="prefetch" href="/assets/js/40.f59e52d6.js"><link rel="prefetch" href="/assets/js/41.1f63cace.js"><link rel="prefetch" href="/assets/js/42.ba755f2b.js"><link rel="prefetch" href="/assets/js/43.c7e587a0.js"><link rel="prefetch" href="/assets/js/44.5b27dbf3.js"><link rel="prefetch" href="/assets/js/45.ff17356a.js"><link rel="prefetch" href="/assets/js/46.c94971bd.js"><link rel="prefetch" href="/assets/js/47.e7b7dfad.js"><link rel="prefetch" href="/assets/js/48.5b8aded5.js"><link rel="prefetch" href="/assets/js/49.8e4b5252.js"><link rel="prefetch" href="/assets/js/5.aaa4560f.js"><link rel="prefetch" href="/assets/js/50.b085c8ab.js"><link rel="prefetch" href="/assets/js/51.1a0d5ae2.js"><link rel="prefetch" href="/assets/js/52.9e23352a.js"><link rel="prefetch" href="/assets/js/53.4f652b05.js"><link rel="prefetch" href="/assets/js/54.83e866f2.js"><link rel="prefetch" href="/assets/js/55.0ab340d4.js"><link rel="prefetch" href="/assets/js/56.1c821600.js"><link rel="prefetch" href="/assets/js/57.8945f537.js"><link rel="prefetch" href="/assets/js/58.7a7643b2.js"><link rel="prefetch" href="/assets/js/59.b931756f.js"><link rel="prefetch" href="/assets/js/6.3757addc.js"><link rel="prefetch" href="/assets/js/60.f815edc8.js"><link rel="prefetch" href="/assets/js/61.8ae83109.js"><link rel="prefetch" href="/assets/js/62.77eaf12b.js"><link rel="prefetch" href="/assets/js/63.744ec6cc.js"><link rel="prefetch" href="/assets/js/64.c23cc361.js"><link rel="prefetch" href="/assets/js/65.2df8ada8.js"><link rel="prefetch" href="/assets/js/66.291b7db2.js"><link rel="prefetch" href="/assets/js/67.6bb730bc.js"><link rel="prefetch" href="/assets/js/68.a569f9cd.js"><link rel="prefetch" href="/assets/js/69.7871a62a.js"><link rel="prefetch" href="/assets/js/7.e6be1190.js"><link rel="prefetch" href="/assets/js/70.7f933dbe.js"><link rel="prefetch" href="/assets/js/71.95ac03d0.js"><link rel="prefetch" href="/assets/js/72.f23dfca3.js"><link rel="prefetch" href="/assets/js/73.de1c2963.js"><link rel="prefetch" href="/assets/js/74.2dc857f8.js"><link rel="prefetch" href="/assets/js/75.c1c8dd1a.js"><link rel="prefetch" href="/assets/js/76.3929f422.js"><link rel="prefetch" href="/assets/js/77.72a2fd96.js"><link rel="prefetch" href="/assets/js/78.4d969c79.js"><link rel="prefetch" href="/assets/js/79.8d030a79.js"><link rel="prefetch" href="/assets/js/80.82b3b4f6.js"><link rel="prefetch" href="/assets/js/81.06a32cb0.js"><link rel="prefetch" href="/assets/js/82.0efce65a.js"><link rel="prefetch" href="/assets/js/83.44398db8.js"><link rel="prefetch" href="/assets/js/84.b314840c.js"><link rel="prefetch" href="/assets/js/9.e9d421eb.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.44ce315c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6883bceb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container" data-v-4698c43e><div data-v-4698c43e><div id="loader-wrapper" class="loading-wrapper" data-v-1c4f0192 data-v-4698c43e data-v-4698c43e><div class="loader-main" data-v-1c4f0192><div data-v-1c4f0192></div><div data-v-1c4f0192></div><div data-v-1c4f0192></div><div data-v-1c4f0192></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-6cbeab0a data-v-4698c43e data-v-4698c43e><h3 class="title" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a>超赞的博客</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><input type="password" value="" data-v-6cbeab0a> <span data-v-6cbeab0a>Konck! Knock!</span> <button data-v-6cbeab0a>OK</button></label> <div class="footer" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><span data-v-6cbeab0a><i class="iconfont reco-theme" data-v-6cbeab0a></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-6cbeab0a>vuePress-theme-reco</a></span> <span data-v-6cbeab0a><i class="iconfont reco-copyright" data-v-6cbeab0a></i> <a data-v-6cbeab0a><span data-v-6cbeab0a>超赞</span>
            
          <span data-v-6cbeab0a>2020 - </span>
          2023
        </a></span></div></div> <div class="hide" data-v-4698c43e><header class="navbar" data-v-4698c43e><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">超赞的博客</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link"><i class="iconfont reco-eye"></i>
  本站指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      技术分享
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>python</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technology/python/automation/python_foundation.html" class="nav-link"><i class="iconfont undefined"></i>
  自动化
</a></li><li class="dropdown-subitem"><a href="/technology/python/web_robot/" class="nav-link"><i class="iconfont undefined"></i>
  爬虫
</a></li><li class="dropdown-subitem"><a href="/technology/python/autoLib/Automation_lib.html" class="nav-link"><i class="iconfont undefined"></i>
  一些python库
</a></li></ul></li><li class="dropdown-item"><h4>前端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technology/css/css1.html" class="nav-link"><i class="iconfont undefined"></i>
  css
</a></li><li class="dropdown-subitem"><a href="/technology/JavaScript/Design_patterns.html" class="nav-link"><i class="iconfont undefined"></i>
  JS
</a></li><li class="dropdown-subitem"><a href="/technology/JavaScript/JavaScript函数式编程.html" class="nav-link"><i class="iconfont undefined"></i>
  JS函数编程
</a></li><li class="dropdown-subitem"><a href="/technology/JS_Engineering/npm.html" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="iconfont undefined"></i>
  工程化
</a></li></ul></li><li class="dropdown-item"><h4>数据集结构与算法</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technology/algorithm/JS_Algorithms.html" class="nav-link"><i class="iconfont undefined"></i>
  JavaScript数据集结构与算法
</a></li></ul></li><li class="dropdown-item"><h4>git</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technology/git/git_learn.html" class="nav-link"><i class="iconfont undefined"></i>
  git学习
</a></li><li class="dropdown-subitem"><a href="/technology/git/git常用命令.html" class="nav-link"><i class="iconfont undefined"></i>
  git常用命令
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-faq"></i>
      生活分享
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/生活分享/life.html" class="nav-link"><i class="iconfont undefined"></i>
  生活分享
</a></li></ul></div></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-4698c43e></div> <aside class="sidebar" data-v-4698c43e><div class="personal-info-wrapper" data-v-6c8ffc9c><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-6c8ffc9c> <h3 class="name" data-v-6c8ffc9c>
    超赞
  </h3> <div class="num" data-v-6c8ffc9c><div data-v-6c8ffc9c><h3 data-v-6c8ffc9c>63</h3> <h6 data-v-6c8ffc9c>文章</h6></div> <div data-v-6c8ffc9c><h3 data-v-6c8ffc9c>32</h3> <h6 data-v-6c8ffc9c>标签</h6></div></div> <hr data-v-6c8ffc9c></div> <nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link"><i class="iconfont reco-eye"></i>
  本站指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      技术分享
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>python</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technology/python/automation/python_foundation.html" class="nav-link"><i class="iconfont undefined"></i>
  自动化
</a></li><li class="dropdown-subitem"><a href="/technology/python/web_robot/" class="nav-link"><i class="iconfont undefined"></i>
  爬虫
</a></li><li class="dropdown-subitem"><a href="/technology/python/autoLib/Automation_lib.html" class="nav-link"><i class="iconfont undefined"></i>
  一些python库
</a></li></ul></li><li class="dropdown-item"><h4>前端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technology/css/css1.html" class="nav-link"><i class="iconfont undefined"></i>
  css
</a></li><li class="dropdown-subitem"><a href="/technology/JavaScript/Design_patterns.html" class="nav-link"><i class="iconfont undefined"></i>
  JS
</a></li><li class="dropdown-subitem"><a href="/technology/JavaScript/JavaScript函数式编程.html" class="nav-link"><i class="iconfont undefined"></i>
  JS函数编程
</a></li><li class="dropdown-subitem"><a href="/technology/JS_Engineering/npm.html" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="iconfont undefined"></i>
  工程化
</a></li></ul></li><li class="dropdown-item"><h4>数据集结构与算法</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technology/algorithm/JS_Algorithms.html" class="nav-link"><i class="iconfont undefined"></i>
  JavaScript数据集结构与算法
</a></li></ul></li><li class="dropdown-item"><h4>git</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/technology/git/git_learn.html" class="nav-link"><i class="iconfont undefined"></i>
  git学习
</a></li><li class="dropdown-subitem"><a href="/technology/git/git常用命令.html" class="nav-link"><i class="iconfont undefined"></i>
  git常用命令
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-faq"></i>
      生活分享
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/生活分享/life.html" class="nav-link"><i class="iconfont undefined"></i>
  生活分享
</a></li></ul></div></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>JS_Engineering</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/technology/JS_Engineering/Gulp.html" class="sidebar-link">Gulp</a></li><li><a href="/technology/JS_Engineering/npm.html" aria-current="page" class="active sidebar-link">npm</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#包管理工具概述" class="sidebar-link">包管理工具概述</a></li><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#npm包的安装" class="sidebar-link">npm包的安装</a></li><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#包的配置" class="sidebar-link">包的配置</a></li><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#包的使用" class="sidebar-link">包的使用</a></li><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#练习-简易数据爬虫" class="sidebar-link">练习-简易数据爬虫</a></li><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#语义版本" class="sidebar-link">语义版本</a></li><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#npm-脚本-npm-scripts" class="sidebar-link">npm 脚本 （npm scripts）</a></li><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#运行环境配置" class="sidebar-link">运行环境配置</a></li><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#其他npm命令-ignore" class="sidebar-link">其他npm命令 {ignore}</a></li><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#发布包" class="sidebar-link">发布包</a></li><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#yarn-简介" class="sidebar-link">yarn 简介</a></li><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#yarn-的核心命令" class="sidebar-link">yarn 的核心命令</a></li><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#yarn-的特别礼物" class="sidebar-link">yarn 的特别礼物</a></li><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#cnpm" class="sidebar-link">cnpm</a></li><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#nvm" class="sidebar-link">nvm</a></li><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#pnpm" class="sidebar-link">pnpm</a></li><li class="sidebar-sub-header"><a href="/technology/JS_Engineering/npm.html#pnpm-原理" class="sidebar-link">pnpm 原理</a></li></ul></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-6cbeab0a data-v-4698c43e><h3 class="title" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a>npm</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><input type="password" value="" data-v-6cbeab0a> <span data-v-6cbeab0a>Konck! Knock!</span> <button data-v-6cbeab0a>OK</button></label> <div class="footer" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><span data-v-6cbeab0a><i class="iconfont reco-theme" data-v-6cbeab0a></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-6cbeab0a>vuePress-theme-reco</a></span> <span data-v-6cbeab0a><i class="iconfont reco-copyright" data-v-6cbeab0a></i> <a data-v-6cbeab0a><span data-v-6cbeab0a>超赞</span>
            
          <span data-v-6cbeab0a>2020 - </span>
          2023
        </a></span></div></div> <div data-v-4698c43e><main class="page"><!----> <div class="page-title" style="display:none;"><h1>npm</h1> <hr> <div data-v-484a899e><i class="iconfont reco-account" data-v-484a899e><span data-v-484a899e>超赞</span></i> <i class="iconfont reco-date" data-v-484a899e><span data-v-484a899e>2020-06-30 16:15:03</span></i> <!----> <i class="iconfont reco-tag tags" data-v-484a899e><span class="tag-item" data-v-484a899e>
      npm
    </span><span class="tag-item" data-v-484a899e>
      工程化
    </span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><h2 id="包管理工具概述"><a href="#包管理工具概述" class="header-anchor">#</a> 包管理工具概述</h2> <blockquote><p>前置知识：JavaScript、ES6、模块化、git 本门课程的所有代码均书写在 nodejs 环境中，不涉及浏览器环境</p></blockquote> <h3 id="概念"><a href="#概念" class="header-anchor">#</a> 概念</h3> <p><strong>模块（module）</strong></p> <p>通常以单个文件形式存在的功能片段，入口文件通常称之为<strong>入口模块</strong>或<strong>主模块</strong></p> <p><strong>库（library，简称lib）</strong></p> <p>以一个或多个模块组成的完整功能块，为开发中某一方面的问题提供完整的解决方案</p> <p><strong>包（package）</strong></p> <p>包含元数据的库，这些元数据包括：名称、描述、git主页、许可证协议、作者、依赖等等</p> <p><img src="/assets/img/2019-12-13-10-39-18.a9501bae.png" alt="img"></p> <h3 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h3> <p>CommonJS 的出现，使 node 环境下的 JS 代码可以用模块更加细粒度的划分。一个类、一个函数、一个对象、一个配置等等均可以作为模块，这种细粒度的划分，是开发大型应用的基石。</p> <p>为了解决在开发过程中遇到的常见问题，比如加密、提供常见的工具方法、模拟数据等等，一时间，在前端社区涌现了大量的第三方库。这些库使用 CommonJS 标准书写而成，非常容易使用。</p> <p>然而，在下载使用这些第三方库的时候，遇到难以处理的问题：</p> <ul><li>下载过程繁琐
<ul><li>进入官网或 github 主页</li> <li>找到并下载相应的版本</li> <li>拷贝到工程的目录中</li> <li>如果遇到有同名的库，需要更改名称</li></ul></li> <li><strong>如果该库需要依赖其他库，还需要按照要求先下载其他库</strong></li> <li><strong>开发环境中安装的大量的库如何在生产环境中还原，又如何区分</strong></li> <li><strong>更新一个库极度麻烦</strong></li> <li><strong>自己开发的库，如何在下一次开发使用</strong></li></ul> <p><strong>以上问题，就是包管理工具要解决的问题</strong></p> <h3 id="前端包管理器"><a href="#前端包管理器" class="header-anchor">#</a> 前端包管理器</h3> <blockquote><p>本讲解的包管理器 npm：重点、 yarn：次重点 、其他：了解</p></blockquote> <p>几乎可以这样认为，前端所有的包管理器都是基于 npm 的，目前，npm 即是一个包管理器，也是其他包管理的基石</p> <p>npm 全称为 node package manager，即 node 包管理器，它运行在 node 环境中，让开发者可以用简单的方式完成包的查找、安装、更新、卸载、上传等操作</p> <blockquote><p>npm 之所以要运行在 node 环境，而不是浏览器环境，根本原因是因为浏览器环境无法提供下载、删除、读取本地文件的功能。而 node 属于服务器环境，没有浏览器的种种限制，理论上可以完全掌控运行 node 的计算机。</p></blockquote> <p>npm 的出现，弥补了 node 没有包管理器的缺陷，于是很快，node 在安装文件中内置了 npm，当开发者安装好 node 之后，就自动安装了 npm，不仅如此，node 环境还专门为 npm 提供了良好的支持，使用 npm 下载的包更加方便了。</p> <p>npm 由三部分组成：</p> <ul><li><p>registry：入口</p> <ul><li>可以把它想象成一个庞大的数据库</li> <li>第三方库的开发者，将自己的库按照 npm 的规范，打包上传到数据库中</li> <li>使用者通过统一的地址下载第三方包</li></ul></li> <li><p>官网：</p> <p>https://www.npmjs.com/</p> <ul><li>查询包</li> <li>注册、登录、管理个人信息</li></ul></li> <li><p>CLI：command-line interface 命令行接口</p> <ul><li>这一部分是本文讲解的重点</li> <li>安装好 npm 后，通过 CLI 来使用 npm 的各种功能</li></ul></li></ul> <blockquote><p>node 和 npm 是互相成就的，node 的出现让 npm 火了，npm 的火爆带动了大量的第三方库的发展，很多优秀的第三方库打包上传到了 npm，这些第三方库又为 node 带来了大量的用户</p></blockquote> <h2 id="npm包的安装"><a href="#npm包的安装" class="header-anchor">#</a> npm包的安装</h2> <blockquote><p>安装（install）即下载包 由于 npm 的官方 registry 服务器位于国外，可能受网速影响导致下载缓慢或失败。因此，安装好 npm 之后，需要重新设置 registry 的地址为国内地址。目前，淘宝 <a href="https://gitee.com/link?target=https%3A%2F%2Fregistry.npm.taobao.org" target="_blank" rel="noopener noreferrer">https://registry.npm.taobao.org<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 提供了国内的 registry 地址，先设置到该地址。设置方式为<code>npm config set registry https://registry.npm.taobao.org</code>。设置好后，通过命令<code>npm config get registry</code>进行检查 <img src="/assets/img/2019-12-16-10-25-13.247d60e7.png" alt="img"></p></blockquote> <p>npm 安装一个包，分为两种安装方式：</p> <ol><li>本地安装</li> <li>全局安装</li></ol> <h3 id="本地安装"><a href="#本地安装" class="header-anchor">#</a> 本地安装</h3> <p>使用命令<code>npm install 包名</code>或<code>npm i 包名</code>即可完成本地安装</p> <p>本地安装的包出现在当前目录下的<code>node_modules</code>目录中</p> <blockquote><p>随着开发的进展，<code>node_modules</code>目录会变得异常庞大，目录下的内容不适合直接传输到生产环境，因此通常使用<code>.gitignore</code>文件忽略该目录中的内容 本地安装适用于绝大部分的包，它会在当前目录及其子目录中发挥作用 通常在项目的根目录中使用本地安装 安装一个包的时候，npm 会自动管理依赖，它会下载该包的依赖包到<code>node_modules</code>目录中 如果本地安装的包带有 CLI，npm 会将它的 CLI 脚本文件放置到<code>node_modules/.bin</code>下，使用命令<code>npx 命令名</code>即可调用</p></blockquote> <h3 id="全局安装"><a href="#全局安装" class="header-anchor">#</a> 全局安装</h3> <p>全局安装的包放置在一个特殊的全局目录，该目录可以通过命令<code>npm config get prefix</code>查看</p> <p>使用命令<code>npm install --global 包名</code> 或 <code>npm i -g 包名</code></p> <p>重要：<strong>全局安装的包并非所有工程可用，它仅提供全局的 CLI 工具</strong></p> <p>大部分情况下，都不需要全局安装包，除非：</p> <ol><li>包的版本非常稳定，很少有大的更新</li> <li>提供的 CLI 工具在各个工程中使用的非常频繁</li> <li>CLI 工具仅为开发环境提供支持，而非部署环境</li></ol> <h2 id="包的配置"><a href="#包的配置" class="header-anchor">#</a> 包的配置</h2> <p>目前遇到的问题：</p> <ol><li>拷贝工程后如何还原？</li> <li>如何区分开发依赖和生产依赖？</li> <li>如果自身的项目也是一个包，如何描述包的信息</li></ol> <p>以上这些问题都需要通过包的<strong>配置文件</strong>解决</p> <h3 id="配置文件"><a href="#配置文件" class="header-anchor">#</a> 配置文件</h3> <p>npm 将每个使用 npm 的工程本身都看作是一个包，包的信息需要通过一个名称固定的配置文件来描述</p> <p><strong>配置文件的名称固定为：package.json</strong></p> <p>可以手动创建该文件，而更多的时候，是通过命令<code>npm init</code>创建的</p> <p>配置文件中可以描述大量的信息，包括：</p> <ul><li>name：包的名称，该名称必须是<strong>英文单词字符</strong>，支持连接符</li> <li>version：版本
<ul><li>版本规范：主版本号.次版本号.补丁版本号</li> <li>主版本号：仅当程序发生了重大变化时才会增长，如新增了重要功能、新增了大量的API、技术架构发生了重大变化</li> <li>次版本号：仅当程序发生了一些小变化时才会增长，如新增了一些小功能、新增了一些辅助型的API</li> <li>补丁版本号：仅当解决了一些 bug 或 进行了一些局部优化时更新，如修复了某个函数的 bug、提升了某个函数的运行效率</li></ul></li> <li>description：包的描述</li> <li>homepage：官网地址</li> <li>author：包的作者，必须是有效的 npm 账户名，书写规范是 <code>account &lt;mail&gt;</code>，例如：<code>zhangsan &lt;zhangsan@gmail.com&gt;</code>，不正确的账号和邮箱可能导致发布包时失败</li> <li>repository：包的仓储地址，通常指 git 或 svn 的地址，它是一个对象
<ul><li>type：仓储类型，git 或 svn</li> <li>url：地址</li></ul></li> <li>main：包的入口文件，使用包的人默认从该入口文件导入包的内容</li> <li>keywords: 搜索关键字，发布包后，可以通过该数组中的关键字搜索到包</li></ul> <p>使用<code>npm init --yes</code>或<code>npm init -y</code>可以在生成配置文件时自动填充默认配置</p> <h3 id="保存依赖关系"><a href="#保存依赖关系" class="header-anchor">#</a> 保存依赖关系</h3> <p>大部分时候，我们仅仅是开发项目，并不会把它打包发布出去，尽管如此，我们仍然需要package.json文件</p> <p><strong>package.json文件最重要的作用，是记录当前工程的依赖</strong></p> <ul><li>dependencies：生产环境的依赖包</li> <li>devDependencies：仅开发环境的依赖包</li></ul> <p>配置好依赖后，使用下面的命令即可安装依赖</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>### 本地安装所有依赖 dependencies + devDependencies
npm install
npm i

### 仅安装生产环境的依赖 dependencies
npm install --production
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这样一来，代码移植就不是问题了，只需要移植源代码和package.json文件，不用移植node_modules目录，然后在移植之后通过命令即可重新恢复安装</p> <p>为了更加方便的添加依赖，npm支持在使用install命令时，加入一些额外的参数，用于将安装的依赖包保存到package.json文件中</p> <p>涉及的命令如下</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>### 安装依赖到生产环境
npm i 包名
npm i --save 包名
npm i -S 包名

### 安装依赖到开发环境
npm i --save-dev 包名
npm i -D 包名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>自动保存的依赖版本，例如<code>^15.1.3</code>，这种书写方式叫做语义版本号（semver version），具体规则后续讲解</p></blockquote> <h2 id="包的使用"><a href="#包的使用" class="header-anchor">#</a> 包的使用</h2> <p>nodejs 对 npm 支持非常良好</p> <p>当使用 nodejs 导入模块时，如果模块路径不是以 ./ 或 ../ 开头，则 node 会认为导入的模块来自于 node_modules 目录，例如：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>var _ = require(&quot;lodash&quot;);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>它首先会从当前目录的以下位置寻找文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>node_modules/lodash.js
node_modules/lodash/入口文件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>若当前目录没有这样的文件，则会回溯到上级目录按照同样的方式查找</p> <p>如果到顶级目录都无法找到文件，则抛出错误</p> <p>上面提到的入口文件按照以下规则确定</p> <ol><li>查看导入包的package.json文件，读取main字段作为入口文件</li> <li>若不包含main字段，则使用index.js作为入口文件</li></ol> <blockquote><p>入口文件的规则同样适用于自己工程中的模块 在 node 中，还可以手动指定路径来导入相应的文件，这种情况比较少见</p> <h2 id="练习-简易数据爬虫"><a href="#练习-简易数据爬虫" class="header-anchor">#</a> 练习-简易数据爬虫</h2></blockquote> <p>将豆瓣电影的电影数据抓取下来，保存到本地文件 movie.json 中</p> <p>需要用到的包：</p> <ol><li>axios：专门用于在各种环境中发送网络请求，并获取到服务器响应结果</li> <li>cheerio：jquery的核心逻辑包，支持所有环境，可用于讲一个html字符串转换成为jquery对象，并通过jquery对象完成后续操作</li> <li>fs：node核心模块，专门用于文件处理
<ul><li>fs.writeFile(文件名, 数据)</li></ul></li></ol> <blockquote><p>文件结构：</p> <p>getMovies.js
index.js
movie.json
package-lock.json
package.json</p></blockquote> <p>package.json</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code>
<span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;chapter2&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ISC&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;axios&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.19.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;cheerio&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.0.0-rc.3&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>getMovies.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;axios&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cheerio <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;cheerio&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 得到所有电影的html字符串
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getMoviesHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> resp <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;https://movie.douban.com/chart&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> resp<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 获取所有电影数据
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getMoviesData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getMoviesHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> $ <span class="token operator">=</span> cheerio<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> trs <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;tr.item&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> movies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> trs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> tr <span class="token operator">=</span> trs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">//分析每个tr的数据，得到一部电影对象</span>
        <span class="token keyword">var</span> m <span class="token operator">=</span> <span class="token function">getMovie</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>tr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        movies<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> movies<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 分析tr，得到一部电影对象
 * @param {*} tr 
 */</span>
<span class="token keyword">function</span> <span class="token function">getMovie</span><span class="token punctuation">(</span><span class="token parameter">tr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> name <span class="token operator">=</span> tr<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;div.pl2 a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    name <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\s</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//去掉空白字符</span>
    name <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> imgSrc <span class="token operator">=</span> tr<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;a.nbg img&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&quot;src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> detail <span class="token operator">=</span> tr<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;div.pl2 p.pl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">,</span>
        imgSrc<span class="token punctuation">,</span>
        detail
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> getMoviesData<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><p>index.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> getMovies <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./getMovies&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token function">getMovies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">movies</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> json <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>movies<span class="token punctuation">)</span><span class="token punctuation">;</span>
    fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">&quot;movie.json&quot;</span><span class="token punctuation">,</span> json<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;成功！&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="语义版本"><a href="#语义版本" class="header-anchor">#</a> 语义版本</h2> <p>思考：如果你编写了一个包A，依赖另外一个包B，你在编写代码时，包B的版本是2.4.1，你是希望使用你包的人一定要安装包B，并且是2.4.1版本，还是希望他可以安装更高的版本，如果你希望它安装更高的版本，高的什么程度呢？</p> <p>回顾：版本号规则</p> <p>版本规范：主版本号.次版本号.补丁版本号</p> <ul><li>主版本号：仅当程序发生了重大变化时才会增长，如新增了重要功能、新增了大量的API、技术架构发生了重大变化</li> <li>次版本号：仅当程序发生了一些小变化时才会增长，如新增了一些小功能、新增了一些辅助型的API</li> <li>补丁版本号：仅当解决了一些 bug 或 进行了一些局部优化时更新，如修复了某个函数的 bug、提升了某个函数的运行效率</li></ul> <p>有的时候，我们希望：安装我的依赖包的时候，次版本号和补丁版本号是可以有提升的，但是主版本号不能变化</p> <p>有的时候，我们又希望：安装我的依赖包的时候，只有补丁版本号可以提升，其他都不能提升</p> <p>甚至我们希望依赖包保持固定的版本，尽管这比较少见</p> <p>这样一来，就需要在配置文件中描述清楚具体的依赖规则，而不是直接写上版本号那么简单。</p> <p>这种规则的描述，即<strong>语义版本</strong></p> <p>语义版本的书写规则非常丰富，下面列出了一些常见的书写方式</p> <table><thead><tr><th>符号</th> <th>描述</th> <th>示例</th> <th>示例描述</th></tr></thead> <tbody><tr><td>&gt;</td> <td>大于某个版本</td> <td>&gt;1.2.1</td> <td>大于1.2.1版本</td></tr> <tr><td>&gt;=</td> <td>大于等于某个版本</td> <td>&gt;=1.2.1</td> <td>大于等于1.2.1版本</td></tr> <tr><td>&lt;</td> <td>小于某个版本</td> <td>&lt;1.2.1</td> <td>小于1.2.1版本</td></tr> <tr><td>&lt;=</td> <td>小于等于某个版本</td> <td>&lt;=1.2.1</td> <td>小于等于1.2.1版本</td></tr> <tr><td>-</td> <td>介于两个版本之间</td> <td>1.2.1 - 1.4.5</td> <td>介于1.2.1和1.4.5之间</td></tr> <tr><td>x</td> <td>不固定的版本号</td> <td>1.3.x</td> <td>只要保证主版本号是1，次版本号是3即可</td></tr> <tr><td>~</td> <td>补丁版本号可增</td> <td>~1.3.4</td> <td>保证主版本号是1，次版本号是3，补丁版本号大于等于4</td></tr> <tr><td>^</td> <td>此版本和补丁版本可增</td> <td>^1.3.4</td> <td>保证主版本号是1，次版本号可以大于等于3，补丁版本号可以大于等于4</td></tr> <tr><td>*</td> <td>最新版本</td> <td>*</td> <td>始终安装最新版本</td></tr></tbody></table> <h3 id="避免还原的差异"><a href="#避免还原的差异" class="header-anchor">#</a> 避免还原的差异</h3> <p>版本依赖控制始终是一个两难的问题</p> <p>如果允许版本增加，可以让依赖包的bug得以修复（补丁版本号），可以带来一些意外的惊喜（次版本号），但同样可能带来不确定的风险（新的bug）</p> <p>如果不允许版本增加，可以获得最好的稳定性，但失去了依赖包自我优化的能力</p> <p>而有的时候情况更加复杂，如果依赖包升级后，依赖也发生了变化，会有更多不确定的情况出现</p> <p>基于此，npm 在安装包的时候，会自动生成一个 package-lock.json 文件，该文件记录了安装包时的确切依赖关系</p> <p>当移植工程时，如果移植了 package-lock.json 文件，恢复安装时，会按照 package-lock.json 文件中的确切依赖进行安装，最大限度的避免了差异</p> <h3 id="扩展-npm的差异版本处理"><a href="#扩展-npm的差异版本处理" class="header-anchor">#</a> [扩展]npm的差异版本处理</h3> <p>如果两个包依赖同一个包的不同版本，如下图</p> <p><img src="data:image/png;base64,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" alt="img"></p> <p>面对这种情况，在 node_modules 目录中，不会使用扁平的目录结构，而会形成嵌套的目录，如下图：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>├── node_modules
│   ├── a 
│   │   ├── node_modules
│   │   │   ├── c
│   │   │   <span class="token operator">|</span>   <span class="token operator">|</span>—— c包的文件
│   │   │── a包的文件     
│   ├── b 
│   │   ├── node_modules
│   │   │   ├── c
│   │   │   <span class="token operator">|</span>   <span class="token operator">|</span>—— c包的文件
│   │   │── b包的文件   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="npm-脚本-npm-scripts"><a href="#npm-脚本-npm-scripts" class="header-anchor">#</a> npm 脚本 （npm scripts）</h2> <p>在开发的过程中，我们可能会反复使用很多的 CLI 命令，例如：</p> <ul><li>启动工程命令（node 或 一些第三方包提供的CLI命令）</li> <li>部署工程命令（一些第三方包提供的CLI命令）</li> <li>测试工程命令（一些第三方包提供的CLI命令）</li></ul> <p>这些命令纷繁复杂，根据第三方包的不同命令也会不一样，非常难以记忆</p> <p>于是，npm 非常贴心的支持了脚本，只需要在 package.json 中配置 scripts 字段，即可配置各种脚本名称</p> <p>之后，我们就可以运行简单的指令来完成各种操作了</p> <p>运行方式是 <code>npm run 脚本名称</code></p> <p>不仅如此，npm 还对某些常用的脚本名称进行了简化，下面的脚本名称是不需要使用run的：</p> <ul><li>start</li> <li>stop</li> <li>test</li></ul> <p>一些细节：</p> <ul><li>脚本中可以省略npx</li> <li>start脚本有默认值：node server.js</li></ul> <h2 id="运行环境配置"><a href="#运行环境配置" class="header-anchor">#</a> 运行环境配置</h2> <p>我们书写的代码一般有三种运行环境：</p> <ol><li>开发环境</li> <li>生产环境</li> <li>测试环境</li></ol> <p>有的时候，我们可能需要在 node 代码中根据不同的环境做出不同的处理</p> <p>如何优雅的让 node 知道处于什么环境，是极其重要的</p> <p>通常我们使用如下的处理方式：</p> <p>node中有一个全局变量 global (可以类比浏览器环境的window)，该变量是一个对象，对象中的所有属性均可以直接使用</p> <p>global有一个属性是process，该属性是一个对象，包含了当前运行node程序的计算机的很多信息，其中有一个信息是env，是一个对象，包含了计算机中所有的系统变量</p> <p>通常，我们通过系统变量 NODE_ENV 的值，来判定node程序处于何种环境</p> <p>有两种方式设置 NODE_ENV 的值</p> <ol><li>永久设置</li> <li>临时设置</li></ol> <p>我们一般使用临时设置</p> <p>因此，我们可以配置 scripts 脚本，在设置好了 NODE_ENV 后启动程序</p> <blockquote><p>为了避免不同系统的设置方式的差异，可以使用第三方库 cross-env 对环境变量进行设置</p></blockquote> <h3 id="在node中读取package-json"><a href="#在node中读取package-json" class="header-anchor">#</a> 在node中读取package.json</h3> <p>有的时候，我们可能在 package.json 中配置一些自定义的字段，这些字段需要在node中读取</p> <p>在node 中，可以直接导入一个json格式的文件，它会自动将其转换为js对象</p> <div class="language-markdown line-numbers-mode"><pre class="language-markdown"><code>文件目录
index.js
package.json
test.js
笔记.md
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>package.json</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;chapter2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_ENV=development node index.js&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_ENV=production node index.js&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_ENV=test node index.js&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ISC&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;cross-env&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^6.0.3&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;a&quot;</span><span class="token operator">:</span> <span class="token number">123</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>index.js</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>var a = &quot;没有环境变量&quot;;
console.log(process.env.NODE_ENV)
if(process.env.NODE_ENV === &quot;development&quot;){
    a = &quot;开发环境&quot;
}
else if(process.env.NODE_ENV === &quot;production&quot;){
    a = &quot;生产环境&quot;
}
else if(process.env.NODE_ENV === &quot;test&quot;){
    a = &quot;测试环境&quot;
}
console.log(a)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>test.js</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//读取package.json文件中的版本号

var config = require(&quot;./package.json&quot;)
console.log(config.version)
console.log(config.a)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="其他npm命令-ignore"><a href="#其他npm命令-ignore" class="header-anchor">#</a> 其他npm命令 {ignore}</h2> <h3 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h3> <ol><li>精确安装最新版本</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> --save-exact 包名 
<span class="token function">npm</span> <span class="token function">install</span> -E 包名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol><li>安装指定版本</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> 包名@版本号
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="查询"><a href="#查询" class="header-anchor">#</a> 查询</h3> <ol><li>查询包安装路径</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> root <span class="token punctuation">[</span>-g<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol><li>查看包信息</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> view 包名 <span class="token punctuation">[</span>子信息<span class="token punctuation">]</span>
<span class="token comment">### view aliases：v info show</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol><li>查询安装包</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> list <span class="token punctuation">[</span>-g<span class="token punctuation">]</span> <span class="token punctuation">[</span>--depth<span class="token operator">=</span>依赖深度<span class="token punctuation">]</span>
<span class="token comment">### list aliases: ls  la  ll</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="更新"><a href="#更新" class="header-anchor">#</a> 更新</h3> <ol><li>检查有哪些包需要更新</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> outdated
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol><li>更新包</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> update <span class="token punctuation">[</span>-g<span class="token punctuation">]</span> <span class="token punctuation">[</span>包名<span class="token punctuation">]</span>
<span class="token comment">### update 别名（aliases）：up、upgrade</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="卸载包"><a href="#卸载包" class="header-anchor">#</a> 卸载包</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> uninstall <span class="token punctuation">[</span>-g<span class="token punctuation">]</span> 包名
<span class="token comment">### uninstall aliases: remove, rm, r, un, unlink</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="npm-配置"><a href="#npm-配置" class="header-anchor">#</a> npm 配置</h3> <p>npm的配置会对其他命令产生或多或少的影响</p> <p>安装好npm之后，最终会产生两个配置文件，一个是用户配置，一个是系统配置，当两个文件的配置项有冲突的时候，用户配置会覆盖系统配置</p> <p>通常，我们不关心具体的配置文件，而只关心最终生效的配置</p> <p>通过下面的命令可以查询目前生效的各种配置</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> config <span class="token function">ls</span> <span class="token punctuation">[</span>-l<span class="token punctuation">]</span> <span class="token punctuation">[</span>--json<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>另外，可以通过下面的命令操作配置</p> <p>1.获取某个配置项</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> config get 配置项
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2.设置某个配置项</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> config <span class="token builtin class-name">set</span> 配置项<span class="token operator">=</span>值
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3.移除某个配置项</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm config <span class="token keyword">delete</span> 配置项
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="发布包"><a href="#发布包" class="header-anchor">#</a> 发布包</h2> <h3 id="准备工作"><a href="#准备工作" class="header-anchor">#</a> 准备工作</h3> <ol><li>移除淘宝镜像源</li> <li>到npm官网注册一个账号，并完成邮箱认证</li> <li>本地使用 npm cli 进行登录
<ol><li>使用命令<code>npm login</code>登录</li> <li>使用命令<code>npm whoami</code>查看当前登录的账号</li> <li>使用命令<code>npm logout</code>注销</li></ol></li> <li>创建工程根目录</li> <li>使用npm init进行初始化</li></ol> <h3 id="发布"><a href="#发布" class="header-anchor">#</a> 发布</h3> <ol><li>开发</li> <li>确定版本</li> <li>使用命令<code>npm publish</code>完成发布</li></ol> <p><strong>开源协议</strong></p> <p><img src="/assets/img/2019-12-18-16-03-02.a38aa445.png" alt="img"></p> <p>可以通过网站 <a href="https://gitee.com/link?target=http%3A%2F%2Fchoosealicense.online%2Fappendix%2F" target="_blank" rel="noopener noreferrer">http://choosealicense.online/appendix/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 选择协议，并复制协议内容</p> <h2 id="yarn-简介"><a href="#yarn-简介" class="header-anchor">#</a> yarn 简介</h2> <blockquote><p>yarn 官网：<a href="https://gitee.com/link?target=https%3A%2F%2Fwww.yarnpkg.com%2Fzh-Hans%2F" target="_blank" rel="noopener noreferrer">https://www.yarnpkg.com/zh-Hans/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>yarn 是由Facebook、Google、Exponent 和 Tilde 联合推出了一个新的 JS 包管理工具，<strong>它仍然使用 npm 的registry</strong>，不过提供了全新 CLI 来对包进行管理</p> <p>过去，yarn 的出现极大的抢夺了 npm 的市场，甚至有人戏言，npm 只剩下一个 registry 了。</p> <p>之所以会出现这种情况，是因为在过去，npm 存在下面的问题：</p> <ul><li>依赖目录嵌套层次深：过去，npm 的依赖是嵌套的，这在 windows 系统上是一个极大的问题，由于众所周知的原因，windows 系统无法支持太深的目录</li> <li>下载速度慢
<ul><li>由于嵌套层次的问题，所以npm对包的下载只能是串行的，即前一个包下载完后才会下载下一个包，导致带宽资源没有完全利用</li> <li>多个相同版本的包被重复的下载</li></ul></li> <li>控制台输出繁杂：过去，npm 安装包的时候，每安装一个依赖，就会输出依赖的详细信息，导致一次安装有大量的信息输出到控制台，遇到错误极难查看</li> <li>工程移植问题：由于 npm 的版本依赖可以是模糊的，可能会导致工程移植后，依赖的确切版本不一致。</li></ul> <p>针对上述问题，yarn 从诞生那天就已经解决，它用到了以下的手段：</p> <ul><li>使用扁平的目录结构</li> <li>并行下载</li> <li>使用本地缓存</li> <li>控制台仅输出关键信息</li> <li>使用yanr-lock文件记录确切依赖</li></ul> <p>不仅如此，yarn还优化了以下内容：</p> <ul><li>增加了某些功能强大的命令</li> <li>让既有的命令更加语义化</li> <li>本地安装的CLI工具可以使用 yarn 直接启动</li> <li>将全局安装的目录当作一个普通的工程，生成package.json文件，便于全局安装移植</li></ul> <p>yarn 的出现给 npm 带来了巨大的压力，很快，npm 学习了 yarn 先进的理念，不断的对自身进行优化，到了目前的npm6版本，几乎完全解决了上面的问题：</p> <ul><li>目录扁平化</li> <li>并行下载</li> <li>本地缓存</li> <li>使用package-lock记录确切依赖</li> <li>增加了大量的命令别名</li> <li>内置了npx，可以启动本地的CLI工具</li> <li>极大的简化了控制台输出</li></ul> <p><strong>总结</strong></p> <p>npm6 之后，可以说npm已经和yarn非常接近，甚至没有差距了。很多新的项目，又重新从yarn转回到npm。</p> <p>这两个包管理器是目前的主流，都必须要学习。</p> <h2 id="yarn-的核心命令"><a href="#yarn-的核心命令" class="header-anchor">#</a> yarn 的核心命令</h2> <ol><li><strong>初始化</strong></li></ol> <p>初始化：<code>yarn init [--yes/-y]</code></p> <ol><li><strong>安装</strong></li></ol> <p>添加指定包：<code>yarn [global] add package-name [--dev/-D] [--exact/-E]</code></p> <p>安装package.json中的所有依赖：<code>yarn install [--production/--prod]</code></p> <ol><li><strong>脚本和本地CLI</strong></li></ol> <p>运行脚本：<code>yarn run 脚本名</code></p> <blockquote><p>start、stop、test可以省略run</p></blockquote> <p>运行本地安装的CLI：<code>yarn run CLI名</code></p> <ol><li><strong>查询</strong></li></ol> <p>查看bin目录：<code>yarn [global] bin</code></p> <p>查询包信息：<code>yarn info 包名 [子字段]</code></p> <p>列举已安装的依赖：<code>yarn [global] list [--depth=依赖深度]</code></p> <blockquote><p>yarn的list命令和npm的list不同，yarn输出的信息更加丰富，包括顶级目录结构、每个包的依赖版本号</p></blockquote> <ol><li><strong>更新</strong></li></ol> <p>列举需要更新的包：<code>yarn outdated</code></p> <p>更新包：<code>yarn [global] upgrade [包名]</code></p> <ol><li><strong>卸载</strong></li></ol> <p>卸载包：<code>yarn remove 包名</code></p> <h2 id="yarn-的特别礼物"><a href="#yarn-的特别礼物" class="header-anchor">#</a> yarn 的特别礼物</h2> <p>在终端命令上，yarn不仅仅是对npm的命令做了一个改名，还增加了一些原本没有的命令，这些命令在某些时候使用起来非常方便</p> <ol><li><strong>yarn check</strong></li></ol> <p>使用<code>yarn check</code>命令，可以验证package.json文件的依赖记录和lock文件是否一致</p> <p>这对于防止篡改非常有用</p> <ol><li><strong>yarn audit</strong></li></ol> <p>使用<code>yarn audit</code>命令，可以检查本地安装的包有哪些已知漏洞，以表格的形式列出，漏洞级别分为以下几种：</p> <ul><li>INFO：信息级别</li> <li>LOW: 低级别</li> <li>MODERATE：中级别</li> <li>HIGH：高级别</li> <li>CRITICAL：关键级别</li></ul> <ol><li><strong>yarn why</strong></li></ol> <p>使用<code>yarn why 包名</code>命令，可以在控制台打印出为什么安装了这个包，哪些包会用到它</p> <ol><li><strong>yarn create</strong></li></ol> <p>非常有趣的命令</p> <p>今后，我们会学习一些脚手架，所谓脚手架，就是使用一个命令来搭建一个工程结构</p> <p>过去，我们都是使用如下的做法：</p> <ol><li>全局安装脚手架工具</li> <li>使用全局命令搭建脚手架</li></ol> <p>由于大部分脚手架工具都是以<code>create-xxx</code>的方式命名的，比如react的官方脚手架名称为<code>create-react-app</code></p> <p>因此，可以使用<code>yarn create</code>命令来一步完成安装和搭建</p> <p>例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">yarn</span> create react-app my-app<span class="token comment">## 等同于下面的两条命令</span>
<span class="token function">yarn</span> global <span class="token function">add</span> create-react-app
create-react-app my-app
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="cnpm"><a href="#cnpm" class="header-anchor">#</a> cnpm</h2> <blockquote><p>官网地址：<a href="https://gitee.com/link?target=https%3A%2F%2Fnpm.taobao.org%2F" target="_blank" rel="noopener noreferrer">https://npm.taobao.org/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>为解决国内用户连接npm registry缓慢的问题，淘宝搭建了自己的registry，即淘宝npm镜像源</p> <p>过去，npm没有提供修改registry的功能，因此，淘宝提供了一个CLI工具即cnpm，它支持除了<code>npm publish</code>以外的所有命令，只不过连接的是淘宝镜像源</p> <p>如今，npm已经支持修改registry了，可能cnpm唯一的作用就是和npm共存，即如果要使用官方源，则使用npm，如果使用淘宝源，则使用cnpm</p> <h2 id="nvm"><a href="#nvm" class="header-anchor">#</a> nvm</h2> <p>nvm并非包管理器，它是用于管理多个node版本的工具</p> <p>在实际的开发中，可能会出现多个项目分别使用的是不同的node版本，在这种场景下，管理不同的node版本就显得尤为重要</p> <p>nvm就是用于切换版本的一个工具</p> <h3 id="下载和安装"><a href="#下载和安装" class="header-anchor">#</a> 下载和安装</h3> <p>最新版下载地址：<a href="https://gitee.com/link?target=https%3A%2F%2Fgithub.com%2Fcoreybutler%2Fnvm-windows%2Freleases" target="_blank" rel="noopener noreferrer">https://github.com/coreybutler/nvm-windows/releases<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>下载nvm-setup.zip后，直接安装</p> <h3 id="使用nvm"><a href="#使用nvm" class="header-anchor">#</a> 使用nvm</h3> <p>nvm提供了CLI工具，用于管理node版本</p> <p>在终端中输入nvm，以查看各种可用命令</p> <blockquote><p>为了加快下载速度，建议设置淘宝镜像 node淘宝镜像：<a href="https://gitee.com/link?target=https%3A%2F%2Fnpm.taobao.org%2Fmirrors%2Fnode%2F" target="_blank" rel="noopener noreferrer">https://npm.taobao.org/mirrors/node/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> npm淘宝镜像：<a href="https://gitee.com/link?target=https%3A%2F%2Fnpm.taobao.org%2Fmirrors%2Fnpm%2F" target="_blank" rel="noopener noreferrer">https://npm.taobao.org/mirrors/npm/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="pnpm"><a href="#pnpm" class="header-anchor">#</a> pnpm</h2> <p>pnpm是一种新起的包管理器，从npm的下载量看，目前还没有超过yarn，但它的实现方式值得主流包管理器学习，某些开发者极力推荐使用pnpm</p> <p>从结果上来看，它具有以下优势：</p> <ol><li>目前，安装效率高于npm和yarn的最新版</li> <li>极其简洁的node_modules目录</li> <li>避免了开发时使用间接依赖的问题</li> <li>能极大的降低磁盘空间的占用</li></ol> <h3 id="安装和使用"><a href="#安装和使用" class="header-anchor">#</a> 安装和使用</h3> <p>全局安装pnpm</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install -g pnpm
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>之后在使用时，只需要把npm替换为pnpm即可</p> <p>如果要执行安装在本地的CLI，可以使用pnpx，它和 npx 的功能完全一样，唯一不同的是，在使用pnpx执行一个需要安装的命令时，会使用pnpm进行安装</p> <blockquote><p>比如<code>npx mocha</code>执行本地的<code>mocha</code>命令时，如果<code>mocha</code>没有安装，则npx会自动的、临时的安装mocha，安装好后，自动运行mocha命令</p></blockquote> <h3 id="pnpm原理"><a href="#pnpm原理" class="header-anchor">#</a> pnpm原理</h3> <ol><li>同 yarn 和 npm 一样，pnpm 仍然使用缓存来保存已经安装过的包，以及使用 pnpm-lock.yaml 来记录详细的依赖版本</li> <li>不同于 yarn 和 npm， pnpm 使用<strong>符号链接和硬链接</strong>（可将它们想象成快捷方式）的做法来放置依赖，从而规避了从缓存中拷贝文件的时间，使得安装和卸载的速度更快</li> <li>由于使用了<strong>符号链接和硬链接</strong>，pnpm可以规避windows操作系统路径过长的问题，因此，它选择使用树形的依赖结果，有着几乎完美的依赖管理。也因为如此，项目中只能使用直接依赖，而不能使用间接依赖</li></ol> <h3 id="注意事项"><a href="#注意事项" class="header-anchor">#</a> 注意事项</h3> <p>由于 pnpm 会改动 node_modules 目录结构，使得每个包只能使用直接依赖，而不能使用间接依赖，因此，如果使用 pnpm 安装的包中包含间接依赖，则会出现问题(<strong>现在不会了，除非使用了绝对路径</strong>)</p> <p>由于 pnpm 超高的安装卸载效率，越来越多的包开始修正之前的间接依赖代码</p> <h2 id="pnpm-原理"><a href="#pnpm-原理" class="header-anchor">#</a> pnpm 原理</h2> <h3 id="概念-2"><a href="#概念-2" class="header-anchor">#</a> 概念</h3> <blockquote><p>要彻底理解pnpm是怎么做的，需要有一些操作系统知识</p></blockquote> <ol><li><strong>文件的本质</strong></li></ol> <p>在操作系统中，文件实际上是一个指针，只不过它指向的不是内存地址，而是一个外部存储地址（这里的外部存储可以是硬盘、U盘、甚至是网络）</p> <p><img src="/assets/img/2019-12-31-16-29-21.046753dc.png" alt="img"></p> <p>当我们删除文件时，删除的实际上是指针，因此，无论删除多么大的文件，速度都非常快。</p> <p><img src="data:image/png;base64,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" alt="img"></p> <ol><li><strong>文件的拷贝</strong></li></ol> <p>如果你复制一个文件，是将该文件指针指向的内容进行复制，然后产生一个新文件指向新的内容</p> <p><img src="/assets/img/2019-12-31-16-30-25.d34670a2.png" alt="img"></p> <ol><li><strong>硬链接 hard link</strong></li></ol> <p>硬链接的概念来自于 Unix 操作系统，它是指将一个文件A指针复制到另一个文件B指针中，文件B就是文件A的硬链接</p> <p><img src="/assets/img/2019-12-31-16-33-59.a7439249.png" alt="img"></p> <p>通过硬链接，不会产生额外的磁盘占用，并且，两个文件都能找到相同的磁盘内容</p> <p>硬链接的数量没有限制，可以为同一个文件产生多个硬链接</p> <p>windows Vista操作系统开始，支持了创建硬链接的操作，在cmd中使用下面的命令可以创建硬链接</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mklink /h 链接名称 目标文件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>由于文件夹（目录）不存在文件内容，所以文件夹（目录）不能创建硬链接</p> <blockquote><p>由于种种原因，在windows操作系统中，通常不要跨越盘符创建硬链接</p></blockquote> <ol><li><strong>符号链接 symbol link</strong></li></ol> <p>符号链接又称为软连接，如果为某个文件或文件夹A创建符号连接B，则B指向A。</p> <p><img src="/assets/img/2019-12-31-16-46-57.f7851f8c.png" alt="img"></p> <p>windows Vista操作系统开始，支持了创建符号链接的操作，在cmd中使用下面的命令可以创建符号链接：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mklink /d 链接名称 目标文件## /d表示创建的是目录的符号链接，不写则是文件的符号链接
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>早期的windows系统不支持符号链接，但它提供了一个工具junction来达到类似的功能</p></blockquote> <p><strong>符号链接和硬链接的区别</strong></p> <ol><li><p>硬链接仅能链接文件，而符号链接可以链接目录</p></li> <li><p>硬链接在链接完成后仅和文件内容关联，和之前链接的文件没有任何关系。而符号链接始终和之前链接的文件关联，和文件内容不直接相关</p></li> <li><p><strong>快捷方式</strong></p></li></ol> <p>快捷方式类似于符号链接，是windows系统早期就支持的链接方式。</p> <p>它不仅仅是一个指向其他文件或目录的指针，其中还包含了各种信息：如权限、兼容性启动方式等其他各种属性</p> <p>由于快捷方式是windows系统独有的，在跨平台的应用中一般不会使用</p> <ol><li><strong>node环境对硬链接和符号链接的处理</strong></li></ol> <p><strong>硬链接</strong>：硬链接是一个实实在在的文件，node不对其做任何特殊处理，也无法区别对待，实际上，node根本无从知晓该文件是不是一个硬链接</p> <p><strong>符号链接</strong>：由于符号链接指向的是另一个文件或目录，当node执行符号链接下的JS文件时，会使用原始路径。</p> <h3 id="pnpm原理-2"><a href="#pnpm原理-2" class="header-anchor">#</a> pnpm原理</h3> <p>pnpm使用符号链接和硬链接来构建node_modules目录</p> <p>下面用一个例子来说明它的构建方式</p> <p>假设两个包a和b，a依赖b：</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA3kAAAHuCAIAAACtblJQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAACTSSURBVHhe7d0PtFVlnTdweVdN5rD826iVOgzc/BeGITia/20Q0Gnlf1HHhnl1NJh0tCZB0FyO5gDOpGYiuPR9rXQEFbFS/ugaSdGsRIQktQbu8CpWJOCfGLOptXh/9z6b0+FwgYvwu9wLn8+67Z7n2c9+zj5X+/U95+x9brdVq1ZtBwAACf5X9d8AALC5yZoAAGSRNQEAyCJrAgCQRdYEACCLrAkAQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAFlkTAIAssiYAAFlkTQAAssiaAABkkTUBAMgiawIAkEXWBAAgi6wJAEAWWRMAgCyyJgAAWWRNAACyyJoAAGSRNQEAyCJrAgCQRdYEACCLrAkAQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAFlkTAIAssiYAAFlkTQAAssiaAABkkTUBAMgiawIAkEXWBAAgi6wJAEAWWRMAgCyyJgAAWWRNAACyyJoAAGSRNQEAyCJrAgCQRdYEACDLNpc1u3XrNmjQoKoDwEbqElU0TnLcuHFVB9iivK8JAEAWWRMAgCyyJgAAWWRNAACydIqsOWjQoHHjxi1fvnz48OFNTU3dWvXv33/atGnVjNXmz58/ZMiQXXfdtcyJA9ee07BOm3PqxZqxYDxcHFhG4mSiWw6PdWK12q6ap556Ks6kYU4cGN1qRqsyWFstGpMmTar2rVvDU4ijXOQOrEf7q2g7y0tD4Vp/CUqtoiHKZjzB2syYs/ZqbWr4v4xox0i1D+gwqzqBga369esX20ceeWR2q7POOitOb9SoUdWkVasWLVq0yy67xLSGOdGoZqxatWzZspjQq1eve++9t35OdMuEaMejlHaI+TE5DolGGYlHjDljx44th8eB8aD1h4QYLOuUM4ltPEosUo6tJrV1MrFsTBg2bFg1Yx3iqHjQhqNiW+0GWFOUoxClo1aXwtpVNLSnvESNijkxWD+nVriiHY9S2iG1ioaGkymr1T9cm2KRWDBmxuG1A+OoGI92NQnoEJ0la8b//tdOYKXozJs3r3SjGEXhaKgvUeOioFSd1VUpUmnVbxXrR4kp7ViwVvJKFgz1a8behtJcamLtNErkrX/QopxtqPqtI2ufcFltPcUu1o8nFU+26rcqz6vqAKypnVW0PeWl1KiGOSVulmoWjQ6ronEa0W0omLFOHB6nVPXbUtaJx636q8Wpxm+g6gAdohNlzYZMFmIkxhtqVoNSm6pOa31Z//yYUKpkmyWyTeU0anVtwoQJ0W2IsyGmRfmrP5notnkyDfm4PdosuADFplTRhvISS0VhLO02xeQOq6JRKts8mQ2+/I5F2jywPNmGJA2k6iz3BkVR2G233arOajESFe25556r+m3Zaaedqlbr1T+xPeKII0p3PZYvXz6o9buIZ8yYsfbjNmiYMHXq1AiLPXv2rPqrxbRDDz206rSezBtvvNHmyTQ1NUWRrTrts+OOO1YtgLa85yraUF5mzpx5wgknVJ1164AqGiZPntzmyfTo0SMK7Pqv2jzjjDOqVp0TTzwxtgsWLChdoAN0lqy5wVJVNDc3jx49unaReBgxYkS1b7UNxrJSIufMmRMlrM3HnTRp0pAhQ2rXzodqx2qxq2qtae3SedJJJ1VL1IlSHo9ezWhLnOHEiRPjJGuXtB911FHVPoC2tLOKtqe81L+Gb1NHVtHrr7++WqJOqfwvvfRSmQN0Zl3pO4+ieMVL4XiZe/zxx89ebdiwYdXudov62L9//3vvvTdKWMNd4VFAY9fZZ58dVfi6666rHmP27Gr3xpswYUK1xFqqGWuZP3/+xz72sSuuuOKQQw65++67y+TykRPApthc5aUjq2gU+WqJtRxwwAHVJKAzqz5L36IGtqo6a+rXeltlae+y1p2MoVyxXtpReqK9/gtxYkLtIp5yxU/tcvVQam6sU/VXi8HalUZxDuu6tDx2NZzM2lemb9BZrfdONlz/VFZb+8QAQhSfUHXWVF9F21Neor3Bq947poqGaMdDVJ2NUf9w9RquHAU6QGd5X3PmzJnxarjqrBYj8er5+OOPj3a5/LG06y1evLhqbbfdkUceGdunn366dNel9onPtddeG/XuggsuqD301KlTY1vWqWlubq5areIcFi1a1DAYYpF4FlWndZEowU8++WTVb7fJkycfeuihDR9LLVmypGoBtGWDVTS0p7xE2nv00Uerzjp0TBUNEY43eDLrcv/991etOj/60Y9i27t379IFOkAn+gz9qquuqlqrxUjEtdNPPz3aH/nIR2L71ltvte6pzJ8//7bbbqs6reIVcIw0FNxBrapOnSiXd9xxR5S82kOXS4UaDi+3uteU82kYDGuffzmZhq8OjsXjZBo+daoXhbvhBKJ75ZVXVh2AdVh/FQ3tKS9Dhw6NeFputawZN27crrvu2nBsyK6in/vc52LxiRMnVv3Vhg8fPnr06KqzDvEs1v58/+qrr45fQrlDCOgg1fubW1S8jO7XKl7CPlL3vb5xevWfQce0KJpj675eOEpG5Ln6ZxFVKebEeBxYppV1ah+sRzvWKe0iZsbghAkToh3zy4TaaUS7FMT6z1zKh0T10+JR4vzLzGrS6i8EqT/neKw4txhs+AyrXkyOReJ51R9SVo5uNQmgTpSjlhq6oSrazvIS6zQU25gQ08reaHdYFQ2lyNfOuSwYp1f/wf3aysPFNhYsB8ZJlue1/gOBza6zZM0Q8SuqSRSCqA4h6k5Uh2pGq5gQtSMqY+yNaTE5kmWpJtWMVjHYsE7UpmpfW1UylFpWClA8aCnQIQpTKdPRrq+SIdaMvWVaKdZxerFydKsZrerPucyM7nqCZlFqYjmk/B5CtGNbzQCo01pEN1xFQ3vKS0PhivklRxYxEo9VdVbLq6Kh/pxrxb/atw4xM04jzqd2Ju08ENjsusV/yv8Ot6DyAfeMGTNKt+vaap4I0LWookCn1ZW+86iTmD9/flNTU8PFTMXy5cvX/nI4AOqporBNkTU32l577bVixYpvfOMbVX+1qJtz5sw555xzqj4AbVFFYZsia2603Xbbbfz48ZMnTx40aNC0adOiOIbRo0cfddRRo0aNavimDwAaqKKwTZE134shQ4bMnj175513Pumkk6I4hkWLFj3yyCNf/epXqxkArJsqCtuOTnFvEAAAWyXvawIAkEXWBAAgi6wJAEAWWRMAgCzuDWrDgC89XbW22+6xfzuiagHQbgopUHhfEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAFlkTAIAssiYAAFlkTQAAssiaAABkkTUBAMgiawIAkEXWBAAgi6wJAEAWWRMAgCyyJgAAWWRNAACyyJoAAGSRNQEAyCJrAgCQRdYEACCLrAkAQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAFlkTAIAssiYAAFlkTQAAssiaAABkkTUBAMgiawIAkEXWBAAgi6wJAEAWWRMAgCyyJgAAWWRNAACyyJoAAGSRNQEAyCJrAgCQRdYEACCLrAkAQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAFlkTAIAssiYAAFlkTQAAssiaAABkkTUBAMgiawIAkEXWBAAgi6wJAEAWWRMAgCyyJgAAWWRNAACyyJoAAGSRNQEAyCJrAgCQRdYEACCLrAkAQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAFlkTAIAssiYAAFlkTQAAssiaAABkkTUBAMgia3Zh48aN69atW9XZZE899VSsFtuqn6ADHgJgoyikkE3WBAAgi6zZhV1++eWrVq2qOl3BkUceGScc26oPsKUppJBN1gQAIIusCQBAFlmzC2u4pD26gwYNWr58eTSamppiV+jfv//al5CvPWfatGnVvjXFsUOGDNl1111jWmyHDx/e3NxcdsUiMTJ69OjSrYmRGK9Nq9dwSXusEAvWFo8HavMogDwKKWTr1rWuU+kYA770dNXacs47Ye/PDdyn6qxDlLkRI0bU/glG9/HHH49GlJ5rrrlmxx13fPvtt6+++uo5c+bMmzevT58+ZVrsjUq6aNGikSNHfupTn4qRn/70p1dcccWhhx46c+bM2bNn1y4DmjRp0tlnnz1s2LBzzjknumW1OHDWrFlltSisJ510Uv0hUf6OOuqoCRMmXHTRRWWkXtlbmx+lObb1p/rGG28sXLiwdS7QtXWGQho2WEsVUsjmfc2tStS4qIDPPvvsiSeeGGUotjNmzIjxiRMnlgnhzjvvjKIZZe7yyy+POSHKWYz8+Mc/rma0ilfG8Vp57Nix48ePL9PKar169Yq6XObEyFlnnTV06NB40OjGNtox0mZ9bDB//vx40KiPtVOdPHly1N/ai3WALUIhhc1L1tzaRNGpWq122223gQMHPvroo1V/u+3GjBkTr7Brr86Lnj17xmDVafXYY4/Fi+Pzzz+/6reK1b70pS9FIY4CV0ZuvfXW2F511VWxjeK7YsWKMrJBv/nNb2IbL8RLN8Q5uLkS6AwUUtiMZM02PDL28KrVBcXr2qq12vHHHx8vc0s7XuxG4Tv66KNLt97gwYOrVqupU6f269cvamLVX22vvfaK7WuvvVa6MeGuu+667bbbyudQd99999qHtOmAAw7YZZddLrvsMq+/YasUhbTr1lKFFDaneAFEFzV27Nj6f4IN3Zr68dmzZ0c7tqVbr2FXvIiP7rrEmmVaMWrUqBg866yzqv46NDzEvHnzevXqFSNRK4cNG/bII4+UcYAOo5BCNu9rsk7xcjzKWZtOP/30alKr5557Lrbxor9cb9ROffr0WbhwYRTKkSNHNjc3n3TSSf3799+oFQA6OYUUZM1t0ZIlS6rWer3xxhstl7K3pWfPntWk1ts2f/zjH0elixL5ta99rRpttyiUl19++YwZM8oK5YolgE5OIYV2kjW3LVHddtlllyeffLLq15k+fXrVanXKKadEwdrg97TNnz9/xIgR//Iv/xKV7u67777++uvf82VDscKhhx66wUcE2LIUUtgosuY2Z8iQIbfddlvt/sciujFYdVoNGDAgimm5fqjepEmTyhcdl+4FF1wwcODA8t0cDd/csX6jR4+OdarOanFg/Qt9gM5JIYX2kzW3Oddee22/fv2OO+64iRMnxkvnEI3ojh8/vprRKkpVjEyePDkK2bRp08rM4cOHn3322VEEyz2S48aNi5fs9QfeeuutK1as+Id/+IfSjWO71f1BjnqDBw+eOXNm1Ouycoj2nDlz2vOVcgBblkIKG6G6R4gu6D3cPlksW7YsBsutiyFeT5dbF6M9YcKEMqeYPXt2vMIu00K0Y6S2K0bWvucxRmrj5R7MMh7KIfUrrGtxgI6hkEI2f6OSjhOvuev/tBoAG0shpcvxGToAAFlkTTpOO78iBIB1UUjpcnyGTkdobm7+xS9+cdllly1atGjFihXVKADtppDSRXlfk47wwAMPHHXUUW+88UbDTZoAtJNCShflfU0AALJ4XxMAgCyyJgAAWWRNAACyyJoAAGSRNQEAyCJrAgCQRdYEACCLrAkAQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIEu3VatWVU26oINPu6lqQY55Uy6tWrCVUkjJto0XUlmza4sSOf/By6oObG59Tr1R1mSrp5CSSiH1GToAAFlkTQAAssiaAABkkTUBAMgiawIAkEXWBAAgi6wJAEAWWRMAgCyyJgAAWWRNAACyyJoAAGSRNQEAyCJrAgCQRdYEACCLrAkAQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAFlkTAIAssiYAAFlkTQAAssiaAABkkTUBAMgiawIAkEXWBAAgi6wJAEAWWRMAgCyyJgAAWWRNupKHHhqzcOF9t9xyWdXvQMcee+zDDz8c26q/2j3/NHTuzSPjp81uUUZOPfzgqr9uZWYs0ma35pJLLvnWt761xx57VH2gc9hp9+5/f/MpQ2/4TNVfh3ZO6ySGTzwjfj5+dK+qvyGfHto/5p955YB4mtUQ2zZZky7j9NOP6927ZzQGDz68jHSYSHVf+cpXevTo8YlPfKIaWu3nr/26atV56dVfVa2N1OaBaz/EgQce2Ldv32uuuabqA53DAZ/6i/dv/75Xf7qBCtDOaR3jsJMPilzY/ii5Qfsd3iO2H9p7573293qYFrImXcYDD8xasKA5GtOnP1NGOsydd965++67//u///vXv/71amiLuvrqqxcvXnzkkUfeeOON1RDQCfQ6ZK/YvvyDxaW7Lu2c1jH26b1n5MKqszn87JmW57Xs1TeXvLy0jLCNkzXpSk4+eWRT05kXX9yhASvyXI8ePebOnXv99ddXQ1va0qVLzz///JUrVw4YMOCUU06pRoEtqqnf3jvt3v2XC5e99vPXq6G2tHNa1/Ufdz07/qL777vusbd+vbIaYtsma8L6HHvssZHnItV9+ctfrobasnjp8tJo8yP1jbVk2ZulsZ7P4iNuTpgwIRoXX3xxGQG2rP1bPzv+fy/8snTXpZ3TYKvRbdWqVVWTLujg026a/+DmuVFm7Njhp5127JQp3x8xYvyll5514omH9+z5kZUrfztz5o9ipJq0Wm1CtJubfzFt2jM33TS57KrZY49dv/jFIZ/85L5l2tKlK15//c0ddtj+9tu/88ADs2Lk9NOPGzNmWDSams5sOWC1hx4a07t3z5EjbyvTwsKF95VGsWBB88knr3HzTVGmxWp9+jRdcskZhxyyf/fuH4zJX//6/Y8//lyZU9RPiOf43HMvx5z58xdWu+t861vf6tu37+23376uT89PPfzgK4cMilB47r/eFd2rzz7xs4d94rHnXx5x10NlQpjbeqvQdZNmxHZwvwMPadonGnHIHY/+YNZPft4yY7Vy+Hd++JNr7p0W3Xv+aegBe+9583dnffM/flQmNLjvvvsOPPDA9ZzeJupz6o3zplxadWArtVkK6U67dz/32sHvvP3uXV/+XjXUlnZOW5czrxzwob13fuKeub97538OOq7pw00fisG3fr3ypaf/a+6Ml8ucmsNOPqjXIXuVG3TiEZe98ubsyc/X3mscPvGM0mjTslffvO+6x0q7zIwHje3Hj+5ZPnD/5cJlL8xauHDOqy0zWpVzqzqtxl90f9Va7eNH9zrm3L5l8U8P7b/3x/fcYcftf//uH2K1+nMr+g7a/88P+nB5jg3WXrkzU0i9r0mjO++84gtfOK0ExIhiEUAb7vuunxCiEd0YLN0igua3v/2VOLY2LUYiQda6eY4//pBvfvOqY475ZJx8dONBv/a1SyJclr2hYUJsox0jMV4m1Bx00EERNFeuXDl5cmOSrnnwmXl9/3FMCZohMmJ064NmzZ677BiptATNECHyn//mrw/u2XLZVk05vATNEMtGd11BM0yb1jLzhBNOKF1gS/nE8R+L7QZv92nntPX7iz4fOe68frUQFmnysFMOari5J5Jf38H7l6AZItLt03vPM0cPaOq3dxnZWLt+ZMeIibU0GY8e51Bbf6O8/wPvi9Pb7/AecVYt3e3fF+c28MI1bvqMoBxPqs2gSZcja7KGgQP/MoLXggXNp502qqnpzG9+c3oM1t/3PXbs8JjQ3PyLkSNviwnx841vTFm58rcxeP75f/z+jokTL49YWT/twgvHLl26otq9kcoK8TNlyveroXWLZBnbOPOYH88iziHS5DnnVGksIm9MiJFY6ogjPl/mPPvsSzEycuR5ZU7NZz7T8ozmzZu3dOlmuML9goGf+vVbv7n5u7MiPv7vm+9evHT5n37gT/7urzbpnvq77roronCPHj0iFldDwJbQkXcFRTKL7dzpL4+/6P7v/Nv3y9uBEUBbd7b49ND+EQp//+4fypz4+eHUF2JapLq+g/Yvc8p4/Cx7teWinSfumVsbiZ/am5o1Bx3X9M7b75ZpsY3FY7UDPvUX1e7ttotDyrHlHdD1iIQap/fLhcvi5GP+C7NaPlOKkY/u+2dlQjQiKEfjZ88svueq6WXN8jRjJLqts+gyZE3WEJHriSeeP/nkkeUD5Wuv/b8lIJ5++nGt+1vCaGzHjPl27QPum26afNddLe+u/dVf9Ssjxx9/SO/ePePA887759q0xx9/7vXXq8sQs33xi1+PM49GPItp01puWt9vv+rdxAsv/Gw8xwiXI0aML08t5px99tXRjnDc8Nbm/vu3FLsXX3yxdDdRhMvzb76nvEk5r3nJ3bOejUbfpvf4HkPNK6+8Etvjjqv+AQEd7+NH99phx+03eLtPO6dtUOS8Wd+e88OHXoh2LPXS0/8VjR12anmPMESS6/nJlkT7gyk/KXPC3Bkvf//bc6IRke69vbUZUW/qDbN++uSiaMf2lRdb3pr9052rB91Yryz4VaxWfg+zJ1Wfnu+8546tO6tGDP7HXc+WXfGI5WnuttfmvGWejiFrsoaIXKNGTaw6reoDYiTOCGoLFjQ3XP5YLtY84ICWC95DyaNz5/6shLkONmXK9+tPb8mSNW7WOeSQ/WK79vujTz31k9geccQaX5+5/fYtZfTVV/94QdKmiHD52vI//jIffGZebP/0A3/y0d02qXT+53/+Z2x9rztsQeU9xQ3e7tPOaRvU/PyS+gslf/fO76tWq7323+P9278vIlrJhTUR7CLmRuPPW98W3VgR9UrsK/7wuz9Urffk4VtmV61Wv9+01ejkZE3WEMmyISCWrxmqvT0ZevfuuXDhfQ0/MR4xtEzYZ5+W3LNo0S9Kt4O99NIaH07Fmcf5N9xLNGbMsIbzP+20lj8IVHsKxYEHHli1Mv3lvlVGB7qinXbvvk/vPd95+921786p185pm27PnrvGtj4X1rz9ehuD7dSQaFO9+au3Yxu/sU8P7R/baH/86F4HHNHyef1bm/AU2FJkTTa/D37wA7H9zW/eKV3W743/9ouCLqwj7wraRrz289dfWdDyi9rv8B7nXjt4+MQzjjm3b4TOCNA/nFpdFUAXImuy0RYsaG5afbNOw0+ZsHz5W7Hdd9/GS4J22GGNK3tWrGh55bq2hmkZancsNfw0fLvT4sWJf9Wj9tF5w9ceAV1LZ/tbQW/86jexLW8HNtjxz1oG//vNd0u30/rovn+2T+89I1mWD/3DO2+/+7NnFj98y+w236+lk5M12QizZ8+PbY8eH95jj5bPaNZl8eLW16Orb8cp7rzzioYvPKpdVVm/2qWXnpX6vUivvtpyR3n//geU7vqtWNFyOcHee2/q7TttuuCET8X2uYUtd/ZsinJ6m+VOeWBjdfBdQe2xtLnlT0tE1my4BygCXPkKoVdbb+tpUD557yQ+ObDlvsx5j/186g2zyr3td335e7X7hOhyZE02wtKlK5544vnu3T/44IPXn3/+Z2oZ8fTTj4soedVVf1e63/1uy0XfvXv3LCN9+jTde+81xxzzydada1i58rexvf76i2Kp+Bk7dvgXvnBa2ZXkjjtavj+5fGlo7a7zOMPIuI8+elPp1rz8cstlVZvrqs2DenykfJvmR3fbuXxne7Snz9nUm9z33Xff2M6a9ccLaoEO08F3BbVHxNnyNUbHndev9g1H0Rjw94dF45UFv2rIu8uXtEzu+cm9apO3uPdv/77Yxi8tMnqbb9DStciabJxRoyY2N/8icuEVV5z39NMTyo01Y8YMiyhZu7Fm/vyF06e3fNPQ3/7t4Ng7Zcr1/fsfsGBBc/yUCTUzZ7Z8AVAcG0vFT0TAiLPPPvtS2VtEkC2PEj/lDp76m5NqX8bUTnFu3/jGlGgMHnz47bePKIvEGdZ/O33N977XEkwPPvjgzXKXd4TL//OPfzP35pHf+8rnS9C8Y+YPyt3o79nQoUO7d+++ePHiF15wDRN0tIhBnequoJqZtz/zVuu3aR52ykHDJ54RP9HYYcftY3D25OerSau9/IPF5csya5Pj58wrB1S726127DHn9m0Y+fTQ/mWknUooj19aLFWu1yw/0d7YpegMZE02TmTB88775ylTvh+Js4ysXPnbSIcR4L72tUllJFx88Y0xp7xtGYdEu82/KjlixPjYVe58j8lPPPH8qaeOeuWV3I+Db7pp8siRt8U5l9ML8VwiHF944djSrYkA9+KLL0aYu+SSlu+Hf89u/u6s2T9dVPub6f/9u/95buEr102aMX7ak2XkPTvxxBNj++ijj5Yu0JE67V1BkSkfvmX2z55ZHAG3NvLCrIX3XDV97Y+hX/v569NufeqVBb+KxFkNbWmL5i4pZx5nW3sKIVL7fof3GHjRJv0JDLaAVXRlfU69sfoH2RU89NCY9/BO5JZ1yimnLFiw4Ic//GEn/ALLcm6PP/541U8Q/4JV/6rB1us9F9KhN3xm+MQzan/tZl3aOY2aM68cEL+xv774qKrfKoJmpMzyBmc11EUopN7XhPWZOnXqY4891r179xtuuKEa6hwi+1588cXRuOWWW8oI0JE64V1BW43yV9f/a/4aX9L81q9XLnlpjb/NQVcha8IGjBkzZvHixX379v3qV79aDXUCETF3333373znO5GGqyGgA3XCu4K2Mvv+5T61W+l32r1730H7Hzyg5VbIcucTXYisCRuwdOnSK664YuXKlZ/97GeHDh1ajW5REyZMOPDAA5966qnRo0dXQ0DHeviW2eMvun+Dt/u0cxr1Fs1dEtsPN33ohL8/rHxofu61gw875aBInB15ixWbi6wJG/bCCy+MHDnyxRdfnD59ejW0RcWZRND8/Oc/X/UBtiIzJz4zd/rLv1y4rP52pWWvvvnCrIVTb5hV/7fg6RK6rVq1qmrSBR182k3zH7ys6sDm1ufUG+dNubTqwFZKISWVQup9TQAAssiaAABkkTUBAMgiawIAkEXWBAAgi6wJAEAWWRMAgCyyJgAAWWRNAACyyJoAAGSRNQEAyCJrAgCQRdYEACCLrAkAQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAFlkTAIAssiYAAFlkTQAAssiaAABkkTUBAMgiawIAkEXWBAAgi6wJAEAWWRMAgCyyJgAAWWRNAACyyJoAAGSRNQEAyCJrAgCQRdYEACCLrAkAQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAFlkTAIAssiYAAFlkTQAAssiaAABkkTUBAMgiawIAkEXWBAAgi6wJAEAWWRMAgCyyJgAAWWRNAACyyJoAAGSRNQEAyCJrAgCQRdYEACCLrAkAQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAFlkTAIAssiYAAFlkTQAAssiaAABkkTUBAMgiawIAkEXWBAAgi6wJAEAWWRMAgCyyJgAAWWRNAACyyJoAAGSRNQEAyCJrAgCQRdYEACCLrAkAQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAFlkTAIAssiYAAFlkTQAAssiaAABkkTUBAMgiawIAkEXWBAAgi6wJAEAWWRMAgCyyJgAAWWRNAACyyJoAAGSRNQEAyCJrAgCQRdYEACCLrAkAQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAFlkTAIAssiYAAFlkTQAAssiaAABkkTUBAMgiawIAkEXWBAAgi6wJAEAWWRMAgCyyJgAAWWRNAACyyJoAAGSRNQEAyCJrAgCQRdYEACCLrAkAQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAFlkTAIAssiYAAFlkTQAAssiaAABkkTUBAMgiawIAkEXWBAAgi6wJAEAWWRMAgCyyJgAAWWRNAACyyJoAAGSRNQEAyCJrAgCQRdYEACCLrAkAQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAlm6rVq2qmnRBB592U9WCHPOmXFq1YCulkJJtGy+ksiYAAFl8hg4AQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAFlkTAIAssiYAAFlkTQAAssiaAABkkTUBAMgiawIAkEXWBAAgi6wJAEAWWRMAgCyyJgAAWWRNAACyyJoAAGSRNQEAyCJrAgCQRdYEACCLrAkAQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAFlkTAIAssiYAAFlkTQAAssiaAABkkTUBAMgiawIAkEXWBAAgi6wJAEAWWRMAgCyyJgAAWWRNAACyyJoAAGSRNQEAyCJrAgCQRdYEACCLrAkAQBZZEwCALLImAABZZE0AALLImgAAZJE1AQDIImsCAJBF1gQAIIusCQBAFlkTAIAssiYAAFlkTQAAssiaAABkkTUBAMgiawIAkGO77f4/ey9ceoP5ZIoAAAAASUVORK5CYII=" alt="img"></p> <p>假设我们的工程为proj，直接依赖a，则安装时，pnpm会做下面的处理</p> <ol><li>查询依赖关系，得到最终要安装的包：a和b</li> <li>查看a和b是否已经有缓存，如果没有，下载到缓存中，如果有，则进入下一步</li> <li>创建 node_modules 目录，并对目录进行结构初始化</li></ol> <p><img src="/assets/img/2019-12-31-18-09-53.2a9294a5.png" alt="img"></p> <ol><li>从缓存的对应包中使用硬链接放置文件到相应包代码目录中</li></ol> <p><img src="/assets/img/2019-12-31-18-14-31.b0a423f3.png" alt="img"></p> <ol><li>使用符号链接，将每个包的<strong>直接依赖</strong>放置到自己的目录中</li></ol> <p><img src="/assets/img/2019-12-31-18-19-48.d680edd2.png" alt="img"></p> <p>这样做的目的，是为了保证a的代码在执行过程中，可以读取到它们的直接依赖</p> <ol><li>新版本的pnpm为了解决一些书写不规范的包（读取间接依赖）的问题，又将所有的工程非直接依赖，使用符号链接加入到了 .pnpm/node_modules 中</li></ol> <p>在本例中好像没有必要，但是如果b依赖c，a又要直接用c，这种不规范的用法现在pnpm通过这种方式支持了。</p> <blockquote><p>但对于那些使用绝对路径的奇葩写法，可能永远也无法支持</p></blockquote> <ol><li>在工程的node_modules目录中使用符号链接，放置直接依赖</li></ol> <p><img src="/assets/img/2019-12-31-18-27-19.982dfe3e.png" alt="img"></p> <ol><li>完成</li></ol></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">2021-04-07: </span> <span class="time">10/30/2023, 5:14:04 PM</span></div></footer> <!----> <!----></main> <!----> <div class="comments-wrapper" data-v-4698c43e><!----></div></div></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-44bd5a18 data-v-44bd5a18><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-44bd5a18><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-44bd5a18></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-44bd5a18></path></svg></div><!----><div></div><!----><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="https://music.163.com/song/media/outer/url?id=165356.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:200px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="http://p2.music.126.net/XX2gJnI5lGQIxQT0Wz9NAg==/94558000000902.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(http://p2.music.126.net/XX2gJnI5lGQIxQT0Wz9NAg==/94558000000902.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>不要怕 (彝语)</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>瓦其依合</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div><!----></div></div>
    <script src="/assets/js/app.8c8f8633.js" defer></script><script src="/assets/js/8.08618cb1.js" defer></script><script src="/assets/js/1.abb8de29.js" defer></script><script src="/assets/js/14.a5f9e302.js" defer></script><script src="/assets/js/39.76dd4810.js" defer></script>
  </body>
</html>
