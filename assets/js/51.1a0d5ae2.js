(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{1087:function(a,e,t){a.exports=t.p+"assets/img/4.3.创建索引速度对比.ea4f795f.png"},1313:function(a,e,t){"use strict";t.r(e);var s=t(3),n=Object(s.a)({},(function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"mongodb的索引操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mongodb的索引操作"}},[a._v("#")]),a._v(" Mongodb的索引操作")]),a._v(" "),s("h5",{attrs:{id:"学习目标"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#学习目标"}},[a._v("#")]),a._v(" 学习目标")]),a._v(" "),s("ol",[s("li",[a._v("掌握 mongodb索引的创建，删除操作")]),a._v(" "),s("li",[a._v("掌握 mongodb查看索引的方法")]),a._v(" "),s("li",[a._v("掌握 mongodb创建唯一索引的方法")])]),a._v(" "),s("hr"),a._v(" "),s("h3",{attrs:{id:"_1-为什么mongdb需要创建索引"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-为什么mongdb需要创建索引"}},[a._v("#")]),a._v(" 1. 为什么mongdb需要创建索引")]),a._v(" "),s("ul",[s("li",[a._v("加快查询速度")]),a._v(" "),s("li",[a._v("进行数据的去重")])]),a._v(" "),s("h3",{attrs:{id:"_2-mongodb创建简单的索引方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-mongodb创建简单的索引方法"}},[a._v("#")]),a._v(" 2. mongodb创建简单的索引方法")]),a._v(" "),s("ul",[s("li",[a._v("语法："),s("code",[a._v("db.集合名.ensureIndex({属性:1})")]),a._v("，1表示升序， -1表示降序")])]),a._v(" "),s("h3",{attrs:{id:"_3-创建索引前后查询速度对比"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-创建索引前后查询速度对比"}},[a._v("#")]),a._v(" 3. 创建索引前后查询速度对比")]),a._v(" "),s("blockquote",[s("p",[a._v("测试：插入10万条数据到数据库中")])]),a._v(" "),s("p",[a._v("插入数据：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("for(i=0;i<100000;i++){db.t1.insert({name:'test'+i,age:i})}\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("创建索引前：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("db.t1.find({name:'test10000'})\ndb.t1.find({name:'test10000'}).explain('executionStats') # 显示查询操作的详细信息\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("创建索引：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("db.t1.ensureIndex({name:1})\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("创建索引后：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("db.t1.find({name:'test10000'}).explain('executionStats')\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("前后速度对比")]),a._v(" "),s("img",{attrs:{src:t(1087),width:"100%"}}),a._v(" "),s("h3",{attrs:{id:"_4-索引的查看"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-索引的查看"}},[a._v("#")]),a._v(" 4. 索引的查看")]),a._v(" "),s("p",[a._v("默认情况下_id是集合的索引\n查看方式："),s("code",[a._v("db.集合名.getIndexes()")])]),a._v(" "),s("h3",{attrs:{id:"_5-删除索引"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-删除索引"}},[a._v("#")]),a._v(" 5. 删除索引")]),a._v(" "),s("p",[a._v("语法："),s("code",[a._v("db.集合名.dropIndex({'索引名称':1})")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("db.t1.dropIndex({name:1})\ndb.t1.getIndexes()\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h3",{attrs:{id:"_6-mongodb创建唯一索引"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-mongodb创建唯一索引"}},[a._v("#")]),a._v(" 6. mongodb创建唯一索引")]),a._v(" "),s("blockquote",[s("p",[a._v("在默认情况下mongdb的索引域的值是可以相同的，创建唯一索引之后，数据库会在插入数据的时候检查创建索引域的值是否存在，如果存在则不会插入该条数据，但是创建索引仅仅能够提高查询速度,同时降低数据库的插入速度。")])]),a._v(" "),s("h4",{attrs:{id:"_6-1-添加唯一索引的语法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-添加唯一索引的语法"}},[a._v("#")]),a._v(" 6.1 添加唯一索引的语法：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('db.集合名.ensureIndex({"字段名":1}, {"unique":true})\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h4",{attrs:{id:"_6-2-利用唯一索引进行数据去重"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-利用唯一索引进行数据去重"}},[a._v("#")]),a._v(" 6.2 利用唯一索引进行数据去重")]),a._v(" "),s("blockquote",[s("p",[a._v("根据唯一索引指定的字段的值，如果相同，则无法插入数据")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('db.t1.ensureIndex({"name":1}, {"unique":true})\ndb.t1.insert({name: \'test10000\'})\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h3",{attrs:{id:"_7-建立复合索引"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-建立复合索引"}},[a._v("#")]),a._v(" 7. 建立复合索引")]),a._v(" "),s("p",[a._v("在进行数据去重的时候，可能用一个域来保证数据的唯一性，这个时候可以考虑建立复合索引来实现。")]),a._v(" "),s("p",[a._v("例如：抓全贴吧信息，如果把帖子的名字作为唯一索引对数据进行去重是不可取的，因为可能有很多帖子名字相同")]),a._v(" "),s("p",[a._v("建立复合索引的语法："),s("code",[a._v("db.collection_name.ensureIndex({字段1:1,字段2:1})")])]),a._v(" "),s("h3",{attrs:{id:"_8-建立索引注意点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-建立索引注意点"}},[a._v("#")]),a._v(" 8. 建立索引注意点")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("根据需要选择是否需要建立唯一索引")])]),a._v(" "),s("li",[s("p",[a._v("索引字段是升序还是降序在单个索引的情况下不影响查询效率，但是带复合索引的条件下会有影响")])]),a._v(" "),s("li",[s("p",[a._v("数据量巨大并且数据库的读出操作非常频繁的时候才需要创建索引，如果写入操作非常频繁，创建索引会影响写入速度")]),a._v(" "),s("blockquote",[s("p",[a._v("例如：在进行查询的时候如果字段1需要升序的方式排序输出，字段2需要降序的方式排序输出，那么此时复合索引的建立需要把字段1设置为1，字段2设置为-1")])])])]),a._v(" "),s("h4",{attrs:{id:"课后思考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#课后思考"}},[a._v("#")]),a._v(" 课后思考")]),a._v(" "),s("blockquote",[s("p",[a._v("数据库为什么要做读写分离（读写分离的意义）？")])]),a._v(" "),s("h2",{attrs:{id:"小结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[a._v("#")]),a._v(" 小结")]),a._v(" "),s("ol",[s("li",[a._v("掌握mongodb索引的创建，删除操作")]),a._v(" "),s("li",[a._v("掌握mongodb查看索引的方法")]),a._v(" "),s("li",[a._v("掌握mongodb创建唯一索引的方法")])]),a._v(" "),s("hr")])}),[],!1,null,null,null);e.default=n.exports}}]);