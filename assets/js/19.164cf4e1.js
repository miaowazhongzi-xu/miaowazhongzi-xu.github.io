(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{1298:function(s,t,a){"use strict";a.r(t);var n=a(3),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("本阶段课程主要学习requests这个http模块，该模块主要用于发送请求获取响应，该模块有很多的替代模块，比如说urllib模块，但是在工作中用的最多的还是requests模块，requests的代码简洁易懂，相对于臃肿的urllib模块，使用requests编写的爬虫代码将会更少，而且实现某一功能将会简单。因此建议大家掌握该模块的使用")]),s._v(" "),n("h2",{attrs:{id:"requests模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#requests模块"}},[s._v("#")]),s._v(" requests模块")]),s._v(" "),n("h5",{attrs:{id:"知识点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#知识点"}},[s._v("#")]),s._v(" 知识点：")]),s._v(" "),n("ul",[n("li",[s._v("掌握 headers参数的使用")]),s._v(" "),n("li",[s._v("掌握 发送带参数的请求")]),s._v(" "),n("li",[s._v("掌握 headers中携带cookie")]),s._v(" "),n("li",[s._v("掌握 cookies参数的使用")]),s._v(" "),n("li",[s._v("掌握 cookieJar的转换方法")]),s._v(" "),n("li",[s._v("掌握 超时参数timeout的使用")]),s._v(" "),n("li",[s._v("掌握 代理ip参数proxies的使用")]),s._v(" "),n("li",[s._v("掌握 使用verify参数忽略CA证书")]),s._v(" "),n("li",[s._v("掌握 requests模块发送post请求")]),s._v(" "),n("li",[s._v("掌握 利用requests.session进行状态保持")])]),s._v(" "),n("blockquote",[n("p",[s._v("前面我们了解了爬虫的基础知识，接下来我们来学习如何在代码中实现我们的爬虫")])]),s._v(" "),n("h2",{attrs:{id:"_1-requests模块介绍"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-requests模块介绍"}},[s._v("#")]),s._v(" 1. requests模块介绍")]),s._v(" "),n("blockquote",[n("p",[s._v("requests文档"),n("a",{attrs:{href:"https://requests.readthedocs.io/projects/cn/zh_CN/latest/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://requests.readthedocs.io/projects/cn/zh_CN/latest/"),n("OutboundLink")],1)])]),s._v(" "),n("h3",{attrs:{id:"_1-1-requests模块的作用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-requests模块的作用"}},[s._v("#")]),s._v(" 1.1 requests模块的作用：")]),s._v(" "),n("ul",[n("li",[s._v("发送http请求，获取响应数据")])]),s._v(" "),n("h3",{attrs:{id:"_1-2-requests模块是一个第三方模块-需要在你的python-虚拟-环境中额外安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-requests模块是一个第三方模块-需要在你的python-虚拟-环境中额外安装"}},[s._v("#")]),s._v(" 1.2 requests模块是一个第三方模块，需要在你的python(虚拟)环境中额外安装")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("pip/pip3 install requests")])])]),s._v(" "),n("h3",{attrs:{id:"_1-3-requests模块发送get请求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-requests模块发送get请求"}},[s._v("#")]),s._v(" 1.3 requests模块发送get请求")]),s._v(" "),n("blockquote",[n("ol",[n("li",[n("p",[s._v("需求：通过requests向百度首页发送请求，获取该页面的源码")])]),s._v(" "),n("li",[n("p",[s._v("运行下面的代码，观察打印输出的结果")])])])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.2.1-简单的代码实现")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" requests \n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 目标url")]),s._v("\nurl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://www.baidu.com'")]),s._v(" \n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 向目标url发送get请求")]),s._v("\nresponse "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印响应内容")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("text"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h5",{attrs:{id:"知识点-掌握-requests模块发送get请求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#知识点-掌握-requests模块发送get请求"}},[s._v("#")]),s._v(" 知识点：掌握 requests模块发送get请求")]),s._v(" "),n("h2",{attrs:{id:"_2-response响应对象"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-response响应对象"}},[s._v("#")]),s._v(" 2. response响应对象")]),s._v(" "),n("blockquote",[n("p",[s._v("观察上边代码运行结果发现，有好多乱码；这是因为编解码使用的字符集不同早造成的；我们尝试使用下边的办法来解决中文乱码问题")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.2.2-response.content")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" requests \n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 目标url")]),s._v("\nurl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://www.baidu.com'")]),s._v(" \n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 向目标url发送get请求")]),s._v("\nresponse "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印响应内容")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# print(response.text)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("content"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("decode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意这里！")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("ol",[n("li",[n("strong",[s._v("response.text是requests模块按照chardet模块推测出的编码字符集进行解码的结果")])]),s._v(" "),n("li",[s._v("网络传输的字符串都是bytes类型的，所以response.text = response.content.decode('推测出的编码字符集')")]),s._v(" "),n("li",[s._v("我们可以在网页源码中搜索"),n("code",[s._v("charset")]),s._v("，尝试参考该编码字符集，注意存在不准确的情况")])]),s._v(" "),n("h3",{attrs:{id:"_2-1-response-text-和response-content的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-response-text-和response-content的区别"}},[s._v("#")]),s._v(" 2.1 response.text 和response.content的区别：")]),s._v(" "),n("ul",[n("li",[s._v("response.text\n"),n("ul",[n("li",[s._v("类型：str")]),s._v(" "),n("li",[s._v("解码类型： requests模块自动根据HTTP 头部对响应的编码作出有根据的推测，推测的文本编码")])])]),s._v(" "),n("li",[s._v("response.content\n"),n("ul",[n("li",[s._v("类型：bytes")]),s._v(" "),n("li",[s._v("解码类型： 没有指定")])])])]),s._v(" "),n("h5",{attrs:{id:"知识点-掌握-response-text和response-content的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#知识点-掌握-response-text和response-content的区别"}},[s._v("#")]),s._v(" 知识点：掌握 response.text和response.content的区别")]),s._v(" "),n("h3",{attrs:{id:"_2-2-通过对response-content进行decode-来解决中文乱码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-通过对response-content进行decode-来解决中文乱码"}},[s._v("#")]),s._v(" 2.2 通过对response.content进行decode，来解决中文乱码")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("response.content.decode()")]),s._v(" 默认utf-8")]),s._v(" "),n("li",[n("code",[s._v('response.content.decode("GBK")')])]),s._v(" "),n("li",[s._v("常见的编码字符集\n"),n("ul",[n("li",[s._v("utf-8")]),s._v(" "),n("li",[s._v("gbk")]),s._v(" "),n("li",[s._v("gb2312")]),s._v(" "),n("li",[s._v("ascii  （读音：阿斯克码）")]),s._v(" "),n("li",[s._v("iso-8859-1")])])])]),s._v(" "),n("h5",{attrs:{id:"知识点-掌握-利用decode函数对requests-content解决中文乱码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#知识点-掌握-利用decode函数对requests-content解决中文乱码"}},[s._v("#")]),s._v(" 知识点：掌握 利用decode函数对requests.content解决中文乱码")]),s._v(" "),n("h3",{attrs:{id:"_2-3-response响应对象的其它常用属性或方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-response响应对象的其它常用属性或方法"}},[s._v("#")]),s._v(" 2.3 response响应对象的其它常用属性或方法")]),s._v(" "),n("blockquote",[n("p",[n("code",[s._v("response = requests.get(url)")]),s._v("中response是发送请求获取的响应对象；response响应对象中除了text、content获取响应内容以外还有其它常用的属性或方法：")])]),s._v(" "),n("ul",[n("li",[n("code",[s._v("response.url")]),s._v("响应的url；有时候响应的url和请求的url并不一致")]),s._v(" "),n("li",[n("code",[s._v("response.status_code")]),s._v(" 响应状态码")]),s._v(" "),n("li",[n("code",[s._v("response.request.headers")]),s._v(" 响应对应的请求头")]),s._v(" "),n("li",[n("code",[s._v("response.headers")]),s._v(" 响应头")]),s._v(" "),n("li",[n("code",[s._v("response.request._cookies")]),s._v(" 响应对应请求的cookie；返回cookieJar类型")]),s._v(" "),n("li",[n("code",[s._v("response.cookies")]),s._v(" 响应的cookie（经过了set-cookie动作；返回cookieJar类型")]),s._v(" "),n("li",[n("code",[s._v("response.json()")]),s._v("自动将json字符串类型的响应内容转换为python对象（dict or list）")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.2.3-response其它常用属性")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" requests\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 目标url")]),s._v("\nurl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://www.baidu.com'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 向目标url发送get请求")]),s._v("\nresponse "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印响应内容")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# print(response.text)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# print(response.content.decode()) \t\t\t# 注意这里！")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印响应的url")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("status_code"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印响应的状态码")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("request"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印响应对象的请求头")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印响应头")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("request"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_cookies"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印请求携带的cookies")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cookies"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印响应中携带的cookies")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("h5",{attrs:{id:"知识点-掌握-response响应对象的其它常用属性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#知识点-掌握-response响应对象的其它常用属性"}},[s._v("#")]),s._v(" 知识点：掌握 response响应对象的其它常用属性")]),s._v(" "),n("h2",{attrs:{id:"_3-requests模块发送请求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-requests模块发送请求"}},[s._v("#")]),s._v(" 3. requests模块发送请求")]),s._v(" "),n("h3",{attrs:{id:"_3-1-发送带header的请求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-发送带header的请求"}},[s._v("#")]),s._v(" 3.1 发送带header的请求")]),s._v(" "),n("blockquote",[n("p",[s._v("我们先写一个获取百度首页的代码")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" requests\n\nurl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://www.baidu.com'")]),s._v("\n\nresponse "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("content"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("decode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印响应对应请求的请求头信息")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("request"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h4",{attrs:{id:"_3-1-1-思考"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-1-思考"}},[s._v("#")]),s._v(" 3.1.1 思考")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("对比浏览器上百度首页的网页源码和代码中的百度首页的源码，有什么不同？")]),s._v(" "),n("ul",[n("li",[s._v("查看网页源码的方法：\n"),n("ul",[n("li",[s._v("右键-查看网页源代码 或")]),s._v(" "),n("li",[s._v("右键-检查")])])])])]),s._v(" "),n("li",[n("p",[s._v("对比对应url的响应内容和代码中的百度首页的源码，有什么不同？")]),s._v(" "),n("ul",[n("li",[s._v("查看对应url的响应内容的方法：\n"),n("ol",[n("li",[s._v("右键-检查")]),s._v(" "),n("li",[s._v("点击 "),n("code",[s._v("Net work")])]),s._v(" "),n("li",[s._v("勾选 "),n("code",[s._v("Preserve log")])]),s._v(" "),n("li",[s._v("刷新页面")]),s._v(" "),n("li",[s._v("查看"),n("code",[s._v("Name")]),s._v("一栏下和浏览器地址栏相同的url的"),n("code",[s._v("Response")])])])])])]),s._v(" "),n("li",[n("p",[s._v("代码中的百度首页的源码非常少，为什么？")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("需要我们带上请求头信息")]),s._v(" "),n("blockquote",[n("p",[s._v("回顾爬虫的概念，模拟浏览器，欺骗服务器，获取和浏览器一致的内容")])])]),s._v(" "),n("li",[n("p",[s._v("请求头中有很多字段，其中User-Agent字段必不可少，表示客户端的操作系统以及浏览器的信息")])])])])]),s._v(" "),n("h4",{attrs:{id:"_3-1-2-携带请求头发送请求的方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-2-携带请求头发送请求的方法"}},[s._v("#")]),s._v(" 3.1.2 携带请求头发送请求的方法")]),s._v(" "),n("p",[n("code",[s._v("requests.get(url, headers=headers)")])]),s._v(" "),n("ul",[n("li",[s._v("headers参数接收字典形式的请求头")]),s._v(" "),n("li",[s._v("请求头字段名作为key，字段对应的值作为value")])]),s._v(" "),n("h4",{attrs:{id:"_3-1-3-完成代码实现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-3-完成代码实现"}},[s._v("#")]),s._v(" 3.1.3 完成代码实现")]),s._v(" "),n("blockquote",[n("p",[s._v("从浏览器中复制User-Agent，构造headers字典；完成下面的代码后，运行代码查看结果")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" requests\n\nurl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://www.baidu.com'")]),s._v("\n\nheaders "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"User-Agent"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在请求头中带上User-Agent，模拟浏览器发送请求")]),s._v("\nresponse "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" headers"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("content"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印请求头信息")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("request"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h5",{attrs:{id:"知识点-掌握-headers参数的使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#知识点-掌握-headers参数的使用"}},[s._v("#")]),s._v(" 知识点：掌握 headers参数的使用")]),s._v(" "),n("h3",{attrs:{id:"_3-2-发送带参数的请求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-发送带参数的请求"}},[s._v("#")]),s._v(" 3.2 发送带参数的请求")]),s._v(" "),n("blockquote",[n("p",[s._v("我们在使用百度搜索的时候经常发现url地址中会有一个 "),n("code",[s._v("?")]),s._v("，那么该问号后边的就是请求参数，又叫做查询字符串")])]),s._v(" "),n("h4",{attrs:{id:"_3-2-1-在url携带参数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-在url携带参数"}},[s._v("#")]),s._v(" 3.2.1 在url携带参数")]),s._v(" "),n("p",[s._v("直接对含有参数的url发起请求")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" requests\n\nheaders "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"User-Agent"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nurl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://www.baidu.com/s?wd=python'")]),s._v("\n\nresponse "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" headers"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h4",{attrs:{id:"_3-2-2-通过params携带参数字典"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-通过params携带参数字典"}},[s._v("#")]),s._v(" 3.2.2 通过params携带参数字典")]),s._v(" "),n("p",[s._v("​\t1.构建请求参数字典")]),s._v(" "),n("p",[s._v("​\t2.向接口发送请求的时候带上参数字典，参数字典设置给params")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" requests\n\nheaders "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"User-Agent"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这是目标url")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# url = 'https://www.baidu.com/s?wd=python'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最后有没有问号结果都一样")]),s._v("\nurl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://www.baidu.com/s?'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 请求参数是一个字典 即wd=python")]),s._v("\nkw "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'wd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'python'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 带上请求参数发起请求，获取响应")]),s._v("\nresponse "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" headers"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" params"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("kw"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("content"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("h5",{attrs:{id:"知识点-掌握发送带参数的请求的方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#知识点-掌握发送带参数的请求的方法"}},[s._v("#")]),s._v(" 知识点：掌握发送带参数的请求的方法")]),s._v(" "),n("h3",{attrs:{id:"_3-3-在headers参数中携带cookie"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-在headers参数中携带cookie"}},[s._v("#")]),s._v(" 3.3 在headers参数中携带cookie")]),s._v(" "),n("blockquote",[n("p",[s._v("网站经常利用请求头中的Cookie字段来做用户访问状态的保持，那么我们可以在headers参数中添加Cookie，模拟普通用户的请求。我们以github登陆为例：")])]),s._v(" "),n("h4",{attrs:{id:"_3-3-1-github登陆抓包分析"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-1-github登陆抓包分析"}},[s._v("#")]),s._v(" 3.3.1 github登陆抓包分析")]),s._v(" "),n("ol",[n("li",[s._v("打开浏览器，右键-检查，点击Net work，勾选Preserve log")]),s._v(" "),n("li",[s._v("访问github登陆的url地址 "),n("code",[s._v("https://github.com/login")])]),s._v(" "),n("li",[s._v("输入账号密码点击登陆后，访问一个需要登陆后才能获取正确内容的url，比如点击右上角的Your profile访问"),n("code",[s._v("https://github.com/USER_NAME")])]),s._v(" "),n("li",[s._v("确定url之后，再确定发送该请求所需要的请求头信息中的User-Agent和Cookie")])]),s._v(" "),n("p",[n("img",{attrs:{src:a(966),alt:"requests-3-2-1-4"}})]),s._v(" "),n("h4",{attrs:{id:"_3-3-2-完成代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-2-完成代码"}},[s._v("#")]),s._v(" 3.3.2 完成代码")]),s._v(" "),n("ul",[n("li",[s._v("从浏览器中复制User-Agent和Cookie")]),s._v(" "),n("li",[s._v("浏览器中的请求头字段和值与headers参数中必须一致")]),s._v(" "),n("li",[s._v("headers请求参数字典中的Cookie键对应的值是字符串")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" requests\n\nurl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://github.com/USER_NAME'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构造请求头字典")]),s._v("\nheaders "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从浏览器中复制过来的User-Agent")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'User-Agent'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.87 Safari/537.36'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从浏览器中复制过来的Cookie")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Cookie'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxx这里是复制过来的cookie字符串'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 请求头参数字典中携带cookie字符串")]),s._v("\nresp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" headers"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("resp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("text"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h4",{attrs:{id:"_3-3-3-运行代码验证结果"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-3-运行代码验证结果"}},[s._v("#")]),s._v(" 3.3.3 运行代码验证结果")]),s._v(" "),n("blockquote",[n("p",[s._v("在打印的输出结果中搜索title，html中的标题文本内容如果是你的github账号，则成功利用headers参数携带cookie，获取登陆后才能访问的页面")])]),s._v(" "),n("p",[n("img",{attrs:{src:a(967),alt:"requests-3-2-3"}})]),s._v(" "),n("h5",{attrs:{id:"知识点-掌握-headers中携带cookie"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#知识点-掌握-headers中携带cookie"}},[s._v("#")]),s._v(" 知识点：掌握 headers中携带cookie")]),s._v(" "),n("h3",{attrs:{id:"_3-4-cookies参数的使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-cookies参数的使用"}},[s._v("#")]),s._v(" 3.4 cookies参数的使用")]),s._v(" "),n("blockquote",[n("p",[s._v("上一小节我们在headers参数中携带cookie，也可以使用专门的cookies参数")])]),s._v(" "),n("ol",[n("li",[n("p",[s._v("cookies参数的形式：字典")]),s._v(" "),n("p",[n("code",[s._v('cookies = {"cookie的name":"cookie的value"}')])]),s._v(" "),n("ul",[n("li",[s._v("该字典对应请求头中Cookie字符串，以分号、空格分割每一对字典键值对")]),s._v(" "),n("li",[s._v("等号左边的是一个cookie的name，对应cookies字典的key")]),s._v(" "),n("li",[s._v("等号右边对应cookies字典的value")])])]),s._v(" "),n("li",[n("p",[s._v("cookies参数的使用方法")]),s._v(" "),n("p",[n("code",[s._v("response = requests.get(url, cookies)")])])]),s._v(" "),n("li",[n("p",[s._v("将cookie字符串转换为cookies参数所需的字典：")]),s._v(" "),n("p",[n("code",[s._v("cookies_dict = {cookie.split('=')[0]:cookie.split('=')[-1] for cookie in cookies_str.split('; ')}")])])]),s._v(" "),n("li",[n("p",[s._v("注意："),n("strong",[s._v("cookie一般是有过期时间的，一旦过期需要重新获取")])])])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" requests\n\nurl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://github.com/USER_NAME'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构造请求头字典")]),s._v("\nheaders "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'User-Agent'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.87 Safari/537.36'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构造cookies字典")]),s._v("\ncookies_str "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'从浏览器中copy过来的cookies字符串'")]),s._v("\n\ncookies_dict "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("cookie"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'='")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("cookie"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'='")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" cookie "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" cookies_str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'; '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 请求头参数字典中携带cookie字符串")]),s._v("\nresp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" headers"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" cookies"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cookies_dict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("resp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("text"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("h5",{attrs:{id:"知识点-掌握-cookies参数的使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#知识点-掌握-cookies参数的使用"}},[s._v("#")]),s._v(" 知识点：掌握 cookies参数的使用")]),s._v(" "),n("h3",{attrs:{id:"_3-5-cookiejar对象转换为cookies字典的方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-cookiejar对象转换为cookies字典的方法"}},[s._v("#")]),s._v(" 3.5 cookieJar对象转换为cookies字典的方法")]),s._v(" "),n("blockquote",[n("p",[s._v("使用requests获取的resposne对象，具有cookies属性。该属性值是一个cookieJar类型，包含了对方服务器设置在本地的cookie。我们如何将其转换为cookies字典呢？")])]),s._v(" "),n("ol",[n("li",[n("p",[s._v("转换方法")]),s._v(" "),n("p",[n("code",[s._v("cookies_dict = requests.utils.dict_from_cookiejar(response.cookies)")])])]),s._v(" "),n("li",[n("p",[s._v("其中response.cookies返回的就是cookieJar类型的对象")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("requests.utils.dict_from_cookiejar")]),s._v("函数返回cookies字典")])])]),s._v(" "),n("h5",{attrs:{id:"知识点-掌握-cookiejar的转换方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#知识点-掌握-cookiejar的转换方法"}},[s._v("#")]),s._v(" 知识点：掌握 cookieJar的转换方法")]),s._v(" "),n("h3",{attrs:{id:"_3-6-超时参数timeout的使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-超时参数timeout的使用"}},[s._v("#")]),s._v(" 3.6 超时参数timeout的使用")]),s._v(" "),n("blockquote",[n("p",[s._v("在平时网上冲浪的过程中，我们经常会遇到网络波动，这个时候，一个请求等了很久可能任然没有结果。")]),s._v(" "),n("p",[s._v("在爬虫中，一个请求很久没有结果，就会让整个项目的效率变得非常低，这个时候我们就需要对请求进行强制要求，让他必须在特定的时间内返回结果，否则就报错。")])]),s._v(" "),n("ol",[n("li",[n("p",[s._v("超时参数timeout的使用方法")]),s._v(" "),n("p",[n("code",[s._v("response = requests.get(url, timeout=3)")])])]),s._v(" "),n("li",[n("p",[s._v("timeout=3表示：发送请求后，3秒钟内返回响应，否则就抛出异常")])])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" requests\n\n\nurl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://twitter.com'")]),s._v("\nresponse "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" timeout"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置超时时间")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h5",{attrs:{id:"知识点-掌握-超时参数timeout的使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#知识点-掌握-超时参数timeout的使用"}},[s._v("#")]),s._v(" 知识点：掌握 超时参数timeout的使用")]),s._v(" "),n("h3",{attrs:{id:"_3-7-了解代理以及proxy代理参数的使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-了解代理以及proxy代理参数的使用"}},[s._v("#")]),s._v(" 3.7 了解代理以及proxy代理参数的使用")]),s._v(" "),n("blockquote",[n("p",[s._v("proxy代理参数通过指定代理ip，让代理ip对应的正向代理服务器转发我们发送的请求，那么我们首先来了解一下代理ip以及代理服务器")])]),s._v(" "),n("h4",{attrs:{id:"_3-7-1-理解使用代理的过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-1-理解使用代理的过程"}},[s._v("#")]),s._v(" 3.7.1 理解使用代理的过程")]),s._v(" "),n("ol",[n("li",[s._v("代理ip是一个ip，指向的是一个代理服务器")]),s._v(" "),n("li",[s._v("代理服务器能够帮我们向目标服务器转发请求")])]),s._v(" "),n("p",[n("img",{attrs:{src:a(968),alt:"使用代理的过程"}})]),s._v(" "),n("h4",{attrs:{id:"_3-7-2-正向代理和反向代理的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-2-正向代理和反向代理的区别"}},[s._v("#")]),s._v(" 3.7.2 正向代理和反向代理的区别")]),s._v(" "),n("blockquote",[n("p",[s._v("前边提到proxy参数指定的代理ip指向的是正向的代理服务器，那么相应的就有反向服务器；现在来了解一下正向代理服务器和反向代理服务器的区别")])]),s._v(" "),n("ol",[n("li",[s._v("从发送请求的一方的角度，来区分正向或反向代理")]),s._v(" "),n("li",[s._v("为浏览器或客户端（发送请求的一方）转发请求的，叫做正向代理\n"),n("ul",[n("li",[s._v("浏览器知道最终处理请求的服务器的真实ip地址，例如VPN")])])]),s._v(" "),n("li",[s._v("不为浏览器或客户端（发送请求的一方）转发请求、而是为最终处理请求的服务器转发请求的，叫做反向代理\n"),n("ul",[n("li",[s._v("浏览器不知道服务器的真实地址，例如nginx")])])])]),s._v(" "),n("h4",{attrs:{id:"_3-7-3-代理ip-代理服务器-的分类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-3-代理ip-代理服务器-的分类"}},[s._v("#")]),s._v(" 3.7.3 代理ip（代理服务器）的分类")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("根据代理ip的匿名程度，代理IP可以分为下面三类：")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("透明代理(Transparent Proxy)：透明代理虽然可以直接“隐藏”你的IP地址，但是还是可以查到你是谁。目标服务器接收到的请求头如下：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("REMOTE_ADDR = Proxy IP\nHTTP_VIA = Proxy IP\nHTTP_X_FORWARDED_FOR = Your IP\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("匿名代理(Anonymous Proxy)：使用匿名代理，别人只能知道你用了代理，无法知道你是谁。目标服务器接收到的请求头如下：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("REMOTE_ADDR = proxy IP\nHTTP_VIA = proxy IP\nHTTP_X_FORWARDED_FOR = proxy IP\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("高匿代理(Elite proxy或High Anonymity Proxy)：高匿代理让别人根本无法发现你是在用代理，所以是最好的选择。"),n("strong",[s._v("毫无疑问使用高匿代理效果最好")]),s._v("。目标服务器接收到的请求头如下：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("REMOTE_ADDR = Proxy IP\nHTTP_VIA = not determined\nHTTP_X_FORWARDED_FOR = not determined\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])])])])]),s._v(" "),n("li",[n("p",[s._v("根据网站所使用的协议不同，需要使用相应协议的代理服务。从代理服务请求使用的协议可以分为：")]),s._v(" "),n("ul",[n("li",[s._v("http代理：目标url为http协议")]),s._v(" "),n("li",[s._v("https代理：目标url为https协议")]),s._v(" "),n("li",[s._v("socks隧道代理（例如socks5代理）等：\n"),n("ol",[n("li",[s._v("socks 代理只是简单地传递数据包，不关心是何种应用协议（FTP、HTTP和HTTPS等）。")]),s._v(" "),n("li",[s._v("socks 代理比http、https代理耗时少。")]),s._v(" "),n("li",[s._v("socks 代理可以转发http和https的请求")])])])])])]),s._v(" "),n("h4",{attrs:{id:"_3-7-4-proxies代理参数的使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-4-proxies代理参数的使用"}},[s._v("#")]),s._v(" 3.7.4 proxies代理参数的使用")]),s._v(" "),n("blockquote",[n("p",[s._v("为了让服务器以为不是同一个客户端在请求；为了防止频繁向一个域名发送请求被封ip，所以我们需要使用代理ip；那么我们接下来要学习requests模块是如何使用代理ip的")])]),s._v(" "),n("ul",[n("li",[n("p",[s._v("用法：")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("response "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" proxies"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("proxies"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("proxies的形式：字典")])]),s._v(" "),n("li",[n("p",[s._v("例如：")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("proxies "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://12.34.56.79:9527"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://12.34.56.79:9527"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("注意：如果proxies字典中包含有多个键值对，发送请求时将按照url地址的协议来选择使用相应的代理ip")])])]),s._v(" "),n("h5",{attrs:{id:"知识点-掌握-代理ip参数proxies的使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#知识点-掌握-代理ip参数proxies的使用"}},[s._v("#")]),s._v(" 知识点：掌握 代理ip参数proxies的使用")]),s._v(" "),n("h3",{attrs:{id:"_3-8-使用verify参数忽略ca证书"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-使用verify参数忽略ca证书"}},[s._v("#")]),s._v(" 3.8 使用verify参数忽略CA证书")]),s._v(" "),n("blockquote",[n("p",[s._v("在使用浏览器上网的时候，有时能够看到下面的提示（2018年10月之前的12306网站）：")])]),s._v(" "),n("p",[n("img",{attrs:{src:a(969),alt:"12306ssl错误"}})]),s._v(" "),n("ul",[n("li",[s._v("原因：该网站的CA证书没有经过【受信任的根证书颁发机构】的认证")]),s._v(" "),n("li",[n("strong",[n("a",{attrs:{href:"https://blog.csdn.net/yangyuge1987/article/details/79209473/",target:"_blank",rel:"noopener noreferrer"}},[s._v("关于CA证书以及受信任的根证书颁发机构点击了解更多"),n("OutboundLink")],1)]),s._v("，课上我们不做展开")])]),s._v(" "),n("h4",{attrs:{id:"_3-8-1-运行代码查看代码中向不安全的链接发起请求的效果"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-1-运行代码查看代码中向不安全的链接发起请求的效果"}},[s._v("#")]),s._v(" 3.8.1 运行代码查看代码中向不安全的链接发起请求的效果")]),s._v(" "),n("blockquote",[n("p",[s._v("运行下面的代码将会抛出包含"),n("code",[s._v("ssl.CertificateError ...")]),s._v("字样的异常")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" requests\nurl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://sam.huat.edu.cn:8443/selfservice/"')]),s._v("\nresponse "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h4",{attrs:{id:"_3-8-2-解决方案"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-2-解决方案"}},[s._v("#")]),s._v(" 3.8.2 解决方案")]),s._v(" "),n("blockquote",[n("p",[s._v("为了在代码中能够正常的请求，我们使用"),n("code",[s._v("verify=False")]),s._v("参数，此时requests模块发送请求将不做CA证书的验证：verify参数能够忽略CA证书的认证")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" requests\nurl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://sam.huat.edu.cn:8443/selfservice/"')]),s._v(" \nresponse "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("verify"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h5",{attrs:{id:"知识点-掌握-使用verify参数忽略ca证书"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#知识点-掌握-使用verify参数忽略ca证书"}},[s._v("#")]),s._v(" 知识点：掌握 使用verify参数忽略CA证书")]),s._v(" "),n("h2",{attrs:{id:"_4-requests模块发送post请求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-requests模块发送post请求"}},[s._v("#")]),s._v(" 4. requests模块发送post请求")]),s._v(" "),n("blockquote",[n("p",[s._v("思考：哪些地方我们会用到POST请求？")]),s._v(" "),n("ol",[n("li",[s._v("登录注册（ 在web工程师看来POST 比 GET 更安全，url地址中不会暴露用户的账号密码等信息）")]),s._v(" "),n("li",[s._v("需要传输大文本内容的时候（ POST 请求对数据长度没有要求）")])]),s._v(" "),n("p",[s._v("所以同样的，我们的爬虫也需要在这两个地方回去模拟浏览器发送post请求")])]),s._v(" "),n("h3",{attrs:{id:"_4-1-requests发送post请求的方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-requests发送post请求的方法"}},[s._v("#")]),s._v(" 4.1 requests发送post请求的方法")]),s._v(" "),n("ul",[n("li",[n("p",[n("code",[s._v("response = requests.post(url, data)")])])]),s._v(" "),n("li",[n("p",[n("code",[s._v("data")]),s._v("参数接收一个字典")])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("requests模块发送post请求函数的其它参数和发送get请求的参数完全一致")])])])]),s._v(" "),n("h3",{attrs:{id:"_4-2-post请求练习"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-post请求练习"}},[s._v("#")]),s._v(" 4.2 POST请求练习")]),s._v(" "),n("p",[s._v("下面面我们通过金山翻译的例子看看post请求如何使用：")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("地址：http://fy.iciba.com/")]),s._v(" "),n("h5",{attrs:{id:"思路分析"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#思路分析"}},[s._v("#")]),s._v(" 思路分析")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("抓包确定请求的url地址")]),s._v(" "),n("img",{attrs:{src:a(970),width:"70%"}})]),s._v(" "),n("li",[n("p",[s._v("确定请求的参数")]),s._v(" "),n("img",{attrs:{src:a(971),width:"70%"}})]),s._v(" "),n("li",[n("p",[s._v("确定返回数据的位置")]),s._v(" "),n("img",{attrs:{src:a(972),width:"70%"}})]),s._v(" "),n("li",[n("p",[s._v("模拟浏览器获取数据")])])])])]),s._v(" "),n("h4",{attrs:{id:"_4-2-3-抓包分析的结论"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-3-抓包分析的结论"}},[s._v("#")]),s._v(" 4.2.3 抓包分析的结论")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("url地址："),n("code",[s._v("http://fy.iciba.com/")])])]),s._v(" "),n("li",[n("p",[s._v("请求方法：POST")])]),s._v(" "),n("li",[n("p",[s._v("请求所需参数：")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("data "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'f'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'auto'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 表示被翻译的语言是自动识别")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'t'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'auto'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 表示翻译后的语言是自动识别")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'w'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'人生苦短'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要翻译的中文字符串")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("pc端User-Agent")]),s._v(":")]),s._v(" "),n("p",[n("code",[s._v("Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36")])])])]),s._v(" "),n("h4",{attrs:{id:"_4-2-4-代码实现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-4-代码实现"}},[s._v("#")]),s._v(" 4.2.4 代码实现")]),s._v(" "),n("blockquote",[n("p",[s._v("了解requests模块发送post请求的方法，以及分析过移动端的百度翻译之后，我们来完成代码")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" requests\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" json\n\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("King")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("object")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("__init__")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" word"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("url "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://fy.iciba.com/ajax.php?a=fy"')]),s._v("\n        self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("word "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" word\n        self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("headers "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"User-Agent"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("post_data "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"f"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"auto"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"t"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"auto"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"w"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("word\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        response "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("post"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" headers"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" data"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("post_data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认返回bytes类型，除非确定外部调用使用str才进行解码操作")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("content\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse_data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将json数据转换成python字典")]),s._v("\n        dict_data "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" json"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("loads"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从字典中抽取翻译结果")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dict_data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'content'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'out'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("except")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dict_data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'content'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'word_mean'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# url")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# headers")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# post——data")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发送请求")]),s._v("\n        data "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get_data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解析")]),s._v("\n        self"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parse_data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" __name__ "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'__main__'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# king = King("人生苦短，及时行乐")')]),s._v("\n    king "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" King"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"China"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    king"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("run"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# python标准库有很多有用的方法，每天看一个标准库的使用")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br")])]),n("h5",{attrs:{id:"知识点-掌握-requests模块发送post请求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#知识点-掌握-requests模块发送post请求"}},[s._v("#")]),s._v(" 知识点：掌握 requests模块发送post请求")]),s._v(" "),n("ul",[n("li")]),s._v(" "),n("h2",{attrs:{id:"_5-利用requests-session进行状态保持"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-利用requests-session进行状态保持"}},[s._v("#")]),s._v(" 5. 利用requests.session进行状态保持")]),s._v(" "),n("blockquote",[n("p",[s._v("requests模块中的Session类能够自动处理发送请求获取响应过程中产生的cookie，进而达到状态保持的目的。接下来我们就来学习它")])]),s._v(" "),n("h3",{attrs:{id:"_5-1-requests-session的作用以及应用场景"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-requests-session的作用以及应用场景"}},[s._v("#")]),s._v(" 5.1 requests.session的作用以及应用场景")]),s._v(" "),n("ul",[n("li",[s._v("requests.session的作用\n"),n("ul",[n("li",[s._v("自动处理cookie，即 "),n("strong",[s._v("下一次请求会带上前一次的cookie")])])])]),s._v(" "),n("li",[s._v("requests.session的应用场景\n"),n("ul",[n("li",[s._v("自动处理连续的多次请求过程中产生的cookie")])])])]),s._v(" "),n("h3",{attrs:{id:"_5-2-requests-session使用方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-requests-session使用方法"}},[s._v("#")]),s._v(" 5.2 requests.session使用方法")]),s._v(" "),n("blockquote",[n("p",[s._v("session实例在请求了一个网站后，对方服务器设置在本地的cookie会保存在session中，下一次再使用session请求对方服务器的时候，会带上前一次的cookie")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("session "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("session"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 实例化session对象")]),s._v("\nresponse "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" session"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nresponse "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" session"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("post"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("ul",[n("li",[s._v("session对象发送get或post请求的参数，与requests模块发送请求的参数完全一致")])]),s._v(" "),n("h3",{attrs:{id:"_5-3-课堂测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-课堂测试"}},[s._v("#")]),s._v(" 5.3 课堂测试")]),s._v(" "),n("blockquote",[n("p",[s._v("使用requests.session来完成github登陆，并获取需要登陆后才能访问的页面")])]),s._v(" "),n("h4",{attrs:{id:"_5-3-1-提示"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-1-提示"}},[s._v("#")]),s._v(" 5.3.1 提示")]),s._v(" "),n("ol",[n("li",[s._v("对github登陆以及访问登陆后才能访问的页面的整个完成过程进行抓包")]),s._v(" "),n("li",[s._v("确定登陆请求的url地址、请求方法和所需的请求参数\n"),n("ul",[n("li",[s._v("部分请求参数在别的url对应的响应内容中，可以使用re模块获取")])])]),s._v(" "),n("li",[s._v("确定登陆后才能访问的页面的的url地址和请求方法")]),s._v(" "),n("li",[s._v("利用requests.session完成代码")])]),s._v(" "),n("h4",{attrs:{id:"_5-3-2-参考代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-2-参考代码"}},[s._v("#")]),s._v(" 5.3.2 参考代码")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" requests\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" re\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构造请求头字典")]),s._v("\nheaders "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'User-Agent'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.87 Safari/537.36'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 实例化session对象")]),s._v("\nsession "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("session"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 访问登陆页获取登陆请求所需参数")]),s._v("\nresponse "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" session"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://github.com/login'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" headers"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nauthenticity_token "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" re"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("search"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'name="authenticity_token" value="(.*?)" />\'')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("text"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("group"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用正则获取登陆请求所需参数")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构造登陆请求参数字典")]),s._v("\ndata "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'commit'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Sign in'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 固定值")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'utf8'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'✓'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 固定值")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'authenticity_token'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" authenticity_token"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 该参数在登陆页的响应内容中")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'login'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("input")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'输入github账号：'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'password'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("input")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'输入github账号：'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发送登陆请求（无需关注本次请求的响应）")]),s._v("\nsession"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("post"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://github.com/session'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" headers"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" data"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印需要登陆后才能访问的页面")]),s._v("\nresponse "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" session"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://github.com/1596930226'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" headers"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("text"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br")])]),n("h5",{attrs:{id:"知识点-掌握-利用requests-session进行状态保持"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#知识点-掌握-利用requests-session进行状态保持"}},[s._v("#")]),s._v(" 知识点：掌握 利用requests.session进行状态保持")])])}),[],!1,null,null,null);t.default=e.exports},966:function(s,t,a){s.exports=a.p+"assets/img/requests-3-2-1-4.034a7c17.png"},967:function(s,t,a){s.exports=a.p+"assets/img/requests-3-2-3.fdb1a1ee.png"},968:function(s,t,a){s.exports=a.p+"assets/img/sydldgc.3db69315.png"},969:function(s,t,a){s.exports=a.p+"assets/img/12306ssl.3a61f40e.png"},970:function(s,t,a){s.exports=a.p+"assets/img/king.4cb5e08c.jpeg"},971:function(s,t,a){s.exports=a.p+"assets/img/formdata.37fd7e10.jpeg"},972:function(s,t,a){s.exports=a.p+"assets/img/responsedata.44043754.jpeg"}}]);